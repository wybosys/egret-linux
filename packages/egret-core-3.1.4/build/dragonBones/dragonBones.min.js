var dragonBones;!function(t){var e=function(){function t(){this.hashCode=t._hashCode++}var e=(__define,t),i=e.prototype;return t._returnObject=function(e){var i=e.constructor,n=String(i),s=null==t._maxCountMap[n]?t._defaultMaxCount:t._maxCountMap[n],a=t._poolsMap[n]=t._poolsMap[n]||[];if(a.length<s){if(!(a.indexOf(e)<0))throw new Error;a.push(e)}},t.toString=function(){throw new Error},t.setMaxCount=function(e,i){if((0>i||i!=i)&&(i=0),e){var n=String(e);t._maxCountMap[n]=i;var s=t._poolsMap[n];s&&s.length>i&&(s.length=i)}else{t._defaultMaxCount=i;for(var n in t._poolsMap)if(null!=t._maxCountMap[n]){var s=t._poolsMap[n];s.length>i&&(s.length=i)}}},t.clearPool=function(e){if(void 0===e&&(e=null),e){var i=t._poolsMap[String(e)];i&&i.length&&(i.length=0)}else for(var n in t._poolsMap){var i=t._poolsMap[n];i.length=0}},t.borrowObject=function(e){var i=t._poolsMap[String(e)];if(i&&i.length)return i.pop();var n=new e;return n._onClear(),n},i.returnToPool=function(){this._onClear(),t._returnObject(this)},t._hashCode=0,t._defaultMaxCount=5e3,t._maxCountMap={},t._poolsMap={},t}();t.BaseObject=e,egret.registerClass(e,"dragonBones.BaseObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this._animations={},this._animationNames=[],this._animationStates=[]}__extends(i,e);var n=__define,s=i,a=s.prototype;return i._sortAnimationState=function(t,e){return t.layer>e.layer?1:-1},i.toString=function(){return"[Class dragonBones.Animation]"},a._onClear=function(){this.timeScale=1,this._animationStateDirty=!1,this._timelineStateDirty=!1,this._armature=null,this._isPlaying=!1,this._time=0,this._lastAnimationState=null;for(var t in this._animations)delete this._animations[t];if(this._animationNames.length&&(this._animationNames.length=0),this._animationStates.length){for(var t=0,e=this._animationStates.length;e>t;++t)this._animationStates[t].returnToPool();this._animationStates.length=0}},a._fadeOut=function(t,e,i,n,s){var a=0,r=this._animationStates.length,o=null;switch(n){case 0:break;case 1:for(;r>a;++a)o=this._animationStates[a],o.layer==e&&o.fadeOut(t,s);break;case 2:for(;r>a;++a)o=this._animationStates[a],o.group==i&&o.fadeOut(t,s);break;case 4:for(;r>a;++a)o=this._animationStates[a],o.fadeOut(t,s);break;case 3:for(;r>a;++a)o=this._animationStates[a],o.layer==e&&o.group==i&&o.fadeOut(t,s)}},a._updateFFDTimelineStates=function(){for(var t=0,e=this._animationStates.length;e>t;++t)this._animationStates[t]._updateFFDTimelineStates()},a._advanceTime=function(t){if(this._isPlaying){0>t&&(t=-t);var e=this._animationStates.length;if(1==e){var i=this._animationStates[0];i._isFadeOutComplete?(i.returnToPool(),this._animationStates.length=0,this._animationStateDirty=!0,this._lastAnimationState=null):(this._timelineStateDirty&&i._updateTimelineStates(),i._advanceTime(t,1,0))}else if(e>1)for(var n=this._animationStates[0]._layer,s=1,a=0,r=1,o=0,l=0;e>o;++o){var i=this._animationStates[o];i._isFadeOutComplete?(l++,i.returnToPool(),this._lastAnimationState==i&&(o-l>=0?this._lastAnimationState=this._animationStates[o-l]:this._lastAnimationState=null)):(l>0&&(this._animationStates[o-l]=i),n!=i._layer&&(n=i._layer,a>=s?s=0:s-=a,a=0),this._timelineStateDirty&&i._updateTimelineStates(),i._advanceTime(t,s,r),i._weightResult&&(a+=i._weightResult,r++)),o==e-1&&l>0&&(this._animationStates.length-=l)}this._timelineStateDirty=!1}},a.reset=function(){this._isPlaying=!1,this._lastAnimationState=null;for(var t=0,e=this._animationStates.length;e>t;++t)this._animationStates[t].returnToPool();this._animationStates.length=0},a.stop=function(t){if(void 0===t&&(t=null),t){var e=this.getState(t);e&&e.stop()}else this._isPlaying=!1},a.play=function(t,e){void 0===t&&(t=null),void 0===e&&(e=-1);var i=null;if(t)i=this.fadeIn(t,0,e,0,null,4);else if(this._lastAnimationState)this._isPlaying?i=this.fadeIn(this._lastAnimationState.name,0,e,0,null,4):this._isPlaying=!0;else{var n=this._armature.armatureData.defaultAnimation;n&&(i=this.fadeIn(n.name,0,e,0,null,4))}return i},a.fadeIn=function(e,n,s,a,r,o,l,h,_,u){void 0===n&&(n=-1),void 0===s&&(s=-1),void 0===a&&(a=0),void 0===r&&(r=null),void 0===o&&(o=3),void 0===l&&(l=!1),void 0===h&&(h=!0),void 0===_&&(_=!0),void 0===u&&(u=!0);var f=this._animations[e];if(!f)return this._time=0,console.warn("No animation."," Armature: "+this._armature.name," Animation: "+e),null;this._isPlaying=!0,(n!=n||0>n)&&(n=this._lastAnimationState?f.fadeInTime:0),0>s&&(s=f.playTimes),this._fadeOut(n,a,r,o,_),this._lastAnimationState=t.BaseObject.borrowObject(t.AnimationState),this._lastAnimationState._layer=a,this._lastAnimationState._group=r,this._lastAnimationState.additiveBlending=l,this._lastAnimationState.displayControl=h,this._lastAnimationState._fadeIn(this._armature,f.animation||f,e,s,f.position,f.duration,this._time,1/f.scale,n,u),this._animationStates.push(this._lastAnimationState),this._animationStateDirty=!0,this._time=0,this._animationStates.length>1&&this._animationStates.sort(i._sortAnimationState);for(var m=this._armature.getSlots(),d=0,c=m.length;c>d;++d){var g=m[d];if(g.inheritAnimation){var p=g.childArmature;p&&p.animation.hasAnimation(e)&&!p.animation.getState(e)&&p.animation.fadeIn(e)}}return 0==n&&(this._armature._delayAdvanceTime=0),this._lastAnimationState},a.gotoAndPlayByTime=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=-1),this._time=e,this.fadeIn(t,0,i,0,null,4)},a.gotoAndPlayByFrame=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1);var n=this._animations[t];return n&&(this._time=n.duration*e/n.frameCount),this.fadeIn(t,0,i,0,null,4)},a.gotoAndPlayByProgress=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1);var n=this._animations[t];return n&&(this._time=n.duration*Math.max(e,0)),this.fadeIn(t,0,i,0,null,4)},a.gotoAndStopByTime=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByTime(t,e,1);return i&&i.stop(),i},a.gotoAndStopByFrame=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByFrame(t,e,1);return i&&i.stop(),i},a.gotoAndStopByProgress=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByProgress(t,e,1);return i&&i.stop(),i},a.getState=function(t){for(var e=0,i=this._animationStates.length;i>e;++e){var n=this._animationStates[e];if(n.name==t)return n}return null},a.hasAnimation=function(t){return null!=this._animations[t]},n(a,"isPlaying",function(){return this._isPlaying}),n(a,"isCompleted",function(){if(this._lastAnimationState){if(!this._lastAnimationState.isCompleted)return!1;for(var t=0,e=this._animationStates.length;e>t;++t)if(!this._animationStates[t].isCompleted)return!1}return!0}),n(a,"lastAnimationName",function(){return this._lastAnimationState?this._lastAnimationState.name:null}),n(a,"lastAnimationState",function(){return this._lastAnimationState}),n(a,"animationNames",function(){return this._animationNames}),n(a,"animations",function(){return this._animations},function(t){if(this._animations!=t){for(var e in this._animations)delete this._animations[e];if(this._animationNames.length=0,t)for(var e in t)this._animations[e]=t[e],this._animationNames.push(e)}}),a.gotoAndPlay=function(t,e,i,n,s,a,r,o,l){void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===n&&(n=-1),void 0===s&&(s=0),void 0===a&&(a=null),void 0===r&&(r=3),void 0===o&&(o=!0),void 0===l&&(l=!0);var h=this.fadeIn(t,e,n,s,a,r,!1,!0,o,l);return h&&i&&i>0&&(h.timeScale=h.totalTime/i),h},a.gotoAndStop=function(t,e){return void 0===e&&(e=0),this.gotoAndStopByTime(t,e)},n(a,"animationList",function(){return this._animationNames}),n(a,"animationDataList",function(){for(var t=[],e=0,i=this._animationNames.length;i>e;++e)t.push(this._animations[this._animationNames[e]]);return t}),i}(t.BaseObject);t.Animation=e,egret.registerClass(e,"dragonBones.Animation")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this._boneMask=[],this._boneTimelines=[],this._slotTimelines=[],this._ffdTimelines=[],this.autoTween=!1}__extends(i,e);var n=__define,s=i,a=s.prototype;return i.toString=function(){return"[Class dragonBones.AnimationState]"},a._onClear=function(){this.displayControl=!0,this.additiveBlending=!1,this.playTimes=1,this.timeScale=1,this.weight=1,this.autoFadeOutTime=-1,this.fadeTotalTime=0,this._isFadeOutComplete=!1,this._layer=0,this._position=0,this._duration=0,this._clipDutation=0,this._weightResult=0,this._fadeProgress=0,this._group=null,this._timeline&&(this._timeline.returnToPool(),this._timeline=null),this._isPlaying=!0,this._isPausePlayhead=!1,this._isFadeOut=!1,this._currentPlayTimes=0,this._fadeTime=0,this._time=0,this._name=null,this._armature=null,this._animationData=null,this._boneMask.length&&(this._boneMask.length=0);for(var t=0,e=this._boneTimelines.length;e>t;++t)this._boneTimelines[t].returnToPool();for(var t=0,e=this._slotTimelines.length;e>t;++t)this._slotTimelines[t].returnToPool();for(var t=0,e=this._ffdTimelines.length;e>t;++t)this._ffdTimelines[t].returnToPool();this._boneTimelines.length=0,this._slotTimelines.length=0,this._ffdTimelines.length=0},a._advanceFadeTime=function(e){0>e&&(e=-e),this._fadeTime+=e;var i=0;if(i=this._fadeTime>=this.fadeTotalTime?this._isFadeOut?0:1:this._fadeTime>0?this._isFadeOut?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime:this._isFadeOut?1:0,this._fadeProgress!=i){this._fadeProgress=i;var n=this._armature._display;if(this._fadeTime<=e)if(this._isFadeOut){if(n.hasEvent(t.EventObject.FADE_OUT)){var s=t.BaseObject.borrowObject(t.EventObject);s.animationState=this,this._armature._bufferEvent(s,t.EventObject.FADE_OUT)}}else if(n.hasEvent(t.EventObject.FADE_IN)){var a=t.BaseObject.borrowObject(t.EventObject);a.animationState=this,this._armature._bufferEvent(a,t.EventObject.FADE_IN)}if(this._fadeTime>=this.fadeTotalTime)if(this._isFadeOut){if(this._isFadeOutComplete=!0,n.hasEvent(t.EventObject.FADE_OUT_COMPLETE)){var r=t.BaseObject.borrowObject(t.EventObject);r.animationState=this,this._armature._bufferEvent(r,t.EventObject.FADE_OUT_COMPLETE)}}else if(this._isPausePlayhead=!1,n.hasEvent(t.EventObject.FADE_IN_COMPLETE)){var o=t.BaseObject.borrowObject(t.EventObject);o.animationState=this,this._armature._bufferEvent(o,t.EventObject.FADE_IN_COMPLETE)}}},a._isDisabled=function(t){return!this.displayControl||t.displayController&&t.displayController!=this._name&&t.displayController!=this._group?!0:!1},a._fadeIn=function(e,i,n,s,a,r,o,l,h,_){this._armature=e,this._animationData=i,this._name=n,this.playTimes=s,this.timeScale=l,this.fadeTotalTime=h,this._position=a,this._duration=r,this._clipDutation=this._animationData.duration,this._time=o,this._isPausePlayhead=_,0==this.fadeTotalTime&&(this._fadeProgress=.999999),this._timeline=t.BaseObject.borrowObject(t.AnimationTimelineState),this._timeline.fadeIn(this._armature,this,this._animationData,this._time),this._updateTimelineStates()},a._updateTimelineStates=function(){var e=this._time;this._animationData.hasAsynchronyTimeline||(e=this._timeline._currentTime);for(var i={},n={},s=0,a=this._boneTimelines.length;a>s;++s){var r=this._boneTimelines[s];i[r.bone.name]=r}for(var o=this._armature.getBones(),s=0,a=o.length;a>s;++s){var l=o[s],h=l.name,_=this._animationData.getBoneTimeline(h);if(_&&this.containsBoneMask(h)){var r=i[h];r?delete i[h]:(r=t.BaseObject.borrowObject(t.BoneTimelineState),r.bone=l,r.fadeIn(this._armature,this,_,e),this._boneTimelines.push(r))}}for(var s in i){var r=i[s];r.bone.invalidUpdate(),this._boneTimelines.splice(this._boneTimelines.indexOf(r),1),r.returnToPool()}for(var s=0,a=this._slotTimelines.length;a>s;++s){var u=this._slotTimelines[s];n[u.slot.name]=u}for(var f=this._armature.getSlots(),s=0,a=f.length;a>s;++s){var m=f[s],d=m.name,c=m.parent.name,g=this._animationData.getSlotTimeline(d);if(g&&this.containsBoneMask(c)&&!this._isFadeOut){var u=n[d];u?delete n[d]:(u=t.BaseObject.borrowObject(t.SlotTimelineState),u.slot=m,u.fadeIn(this._armature,this,g,e),this._slotTimelines.push(u))}}for(var s in n){var u=n[s];this._slotTimelines.splice(this._slotTimelines.indexOf(u),1),u.returnToPool()}this._updateFFDTimelineStates()},a._updateFFDTimelineStates=function(){var e=this._time;this._animationData.hasAsynchronyTimeline||(e=this._timeline._currentTime);for(var i={},n=0,s=this._ffdTimelines.length;s>n;++n){var a=this._ffdTimelines[n];i[a.slot.name]=a}for(var r=this._armature.getSlots(),n=0,s=r.length;s>n;++n){var o=r[n],l=o.name,h=o.parent.name;if(o._meshData){var _=this._animationData.getFFDTimeline(this._armature._skinData.name,l,o.displayIndex);if(_&&this.containsBoneMask(h)){var a=i[l];a?delete i[l]:(a=t.BaseObject.borrowObject(t.FFDTimelineState),a.slot=o,a.fadeIn(this._armature,this,_,e),this._ffdTimelines.push(a))}else{for(var u=0,f=o._ffdVertices.length;f>u;++u)o._ffdVertices[u]=0;o._ffdDirty=!0}}}for(var n in i){var a=i[n];a.slot._ffdDirty=!0,this._ffdTimelines.splice(this._ffdTimelines.indexOf(a),1),a.returnToPool()}},a._advanceTime=function(t,e,i){if(0!=t&&this._advanceFadeTime(t),t*=this.timeScale,0!=t&&this._isPlaying&&!this._isPausePlayhead&&(this._time+=t,this._timeline.update(this._time),this.autoFadeOutTime>=0&&this._fadeProgress>=1&&this._timeline._isCompleted&&this.fadeOut(this.autoFadeOutTime)),this._weightResult=this.weight*this._fadeProgress*e,0!=this._weightResult){var n=this._time;if(this._animationData.hasAsynchronyTimeline||(n=this._timeline._currentTime),this._fadeProgress>=1&&0==i&&this._armature.cacheFrameRate>0){var s=Math.floor(this._timeline._currentTime*this._animationData.cacheTimeToFrameScale);if(this._armature._cacheFrameIndex=s,this._armature._animation._animationStateDirty){this._armature._animation._animationStateDirty=!1;for(var a=0,r=this._boneTimelines.length;r>a;++a){var o=this._boneTimelines[a];o.bone._cacheFrames=o._timeline.cachedFrames}for(var a=0,r=this._slotTimelines.length;r>a;++a){var l=this._slotTimelines[a];l.slot._cacheFrames=l._timeline.cachedFrames}}if(!this._animationData.cachedFrames[s]||this._animationData.hasBoneTimelineEvent){this._animationData.cachedFrames[s]=!0;for(var a=0,r=this._boneTimelines.length;r>a;++a)this._boneTimelines[a].update(n)}}else{this._armature._cacheFrameIndex=-1;for(var a=0,r=this._boneTimelines.length;r>a;++a)this._boneTimelines[a].update(n)}for(var a=0,r=this._slotTimelines.length;r>a;++a)this._slotTimelines[a].update(n);for(var a=0,r=this._ffdTimelines.length;r>a;++a)this._ffdTimelines[a].update(n)}},a.play=function(){this._isPlaying=!0},a.stop=function(){this._isPlaying=!1},a.fadeOut=function(t,e){if(void 0===e&&(e=!0),(0>t||t!=t)&&(t=0),this._isPausePlayhead=e,this._isFadeOut){if(t>t-this._fadeTime)return}else{this._isFadeOut=!0,(0==t||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(var i=0,n=this._boneTimelines.length;n>i;++i)this._boneTimelines[i].fadeOut();for(var i=0,n=this._slotTimelines.length;n>i;++i)this._slotTimelines[i].fadeOut()}this.displayControl=!1,this.fadeTotalTime=this._fadeProgress>1e-6?t/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)},a.containsBoneMask=function(t){return!this._boneMask.length||this._boneMask.indexOf(t)>=0},a.addBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._armature.getBone(t);if(i){if(this._boneMask.indexOf(t)<0&&this._animationData.getBoneTimeline(t)&&this._boneMask.push(t),e)for(var n=this._armature.getBones(),s=0,a=n.length;a>s;++s){var r=n[s],o=r.name;this._boneMask.indexOf(o)<0&&this._animationData.getBoneTimeline(o)&&i.contains(r)&&this._boneMask.push(o)}this._updateTimelineStates()}},a.removeBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._boneMask.indexOf(t);if(i>=0&&this._boneMask.splice(i,1),e){var n=this._armature.getBone(t);if(n)for(var s=this._armature.getBones(),a=0,r=s.length;r>a;++a){var o=s[a],l=o.name,h=this._boneMask.indexOf(l);h>=0&&n.contains(o)&&this._boneMask.splice(h,1)}}this._updateTimelineStates()},a.removeAllBoneMask=function(){this._boneMask.length=0,this._updateTimelineStates()},n(a,"layer",function(){return this._layer}),n(a,"group",function(){return this._group}),n(a,"name",function(){return this._name}),n(a,"clip",function(){return this._animationData}),n(a,"animationData",function(){return this._animationData}),n(a,"isCompleted",function(){return this._timeline._isCompleted}),n(a,"isPlaying",function(){return this._isPlaying&&!this._timeline._isCompleted}),n(a,"currentPlayTimes",function(){return this._currentPlayTimes}),n(a,"totalTime",function(){return this._duration}),n(a,"currentTime",function(){return this._timeline._currentTime},function(t){if((0>t||t!=t)&&(t=0),this._time=t,this._timeline.setCurrentTime(this._time),0!=this._weightResult){var e=this._time;this._animationData.hasAsynchronyTimeline||(e=this._timeline._currentTime);for(var i=0,n=this._boneTimelines.length;n>i;++i)this._boneTimelines[i].setCurrentTime(e);for(var i=0,n=this._slotTimelines.length;n>i;++i)this._slotTimelines[i].setCurrentTime(e);for(var i=0,n=this._ffdTimelines.length;n>i;++i)this._ffdTimelines[i].setCurrentTime(e)}}),i}(t.BaseObject);t.AnimationState=e,egret.registerClass(e,"dragonBones.AnimationState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this)}__extends(i,e);var n=(__define,i),s=n.prototype;return s._onClear=function(){this._isCompleted=!1,this._currentPlayTimes=0,this._currentTime=0,this._timeline=null,this._isReverse=!1,this._hasAsynchronyTimeline=!1,this._keyFrameCount=0,this._frameCount=0,this._position=0,this._duration=0,this._clipDutation=0,this._timeScale=1,this._timeOffset=0,this._timeToFrameSccale=0,this._currentFrame=null,this._armature=null,this._animationState=null},s._onFadeIn=function(){},s._onUpdateFrame=function(t){},s._onArriveAtFrame=function(t){},s._onCrossFrame=function(e){for(var i=e.actions,n=0,s=i.length;s>n;++n){var a=i[n];if(a.slot){var r=this._armature.getSlot(a.slot.name);if(r){var o=r.childArmature;o&&(o._action=a)}}else if(a.bone)for(var l=this._armature.getSlots(),h=0,_=l.length;_>h;++h){var u=l[h].childArmature;u&&(u._action=a)}else this._armature._action=a}for(var f=this._armature._display,m=e.events,n=0,s=m.length;s>n;++n){var d=m[n],c="";switch(d.type){case 0:c=t.EventObject.FRAME_EVENT;break;case 1:c=t.EventObject.SOUND_EVENT}if(f.hasEvent(c)){var g=t.BaseObject.borrowObject(t.EventObject);g.animationState=this._animationState,d.bone&&(g.bone=this._armature.getBone(d.bone.name)),d.slot&&(g.slot=this._armature.getSlot(d.slot.name)),g.name=d.name,g.data=d.data,this._armature._bufferEvent(g,c)}}},s._setCurrentTime=function(t){var e=0;if(this._hasAsynchronyTimeline){var i=this._animationState.playTimes,n=i*this._duration;t*=this._timeScale,0!=this._timeOffset&&(t+=this._timeOffset*this._clipDutation),i>0&&(t>=n||-n>=t)?(this._isCompleted=!0,e=i,t=0>t?0:this._duration):(this._isCompleted=!1,0>t?(e=Math.floor(-t/this._duration),t=this._duration- -t%this._duration):(e=Math.floor(t/this._duration),t%=this._duration),i>0&&e>i&&(e=i)),t+=this._position}else this._isCompleted=this._animationState._timeline._isCompleted,e=this._animationState._timeline._currentPlayTimes;return this._currentTime==t?!1:(1==this._keyFrameCount&&t>this._position&&this!=this._animationState._timeline&&(this._isCompleted=!0),this._isReverse=this._currentTime>t&&this._currentPlayTimes==e,this._currentTime=t,this._currentPlayTimes=e,!0)},s.setCurrentTime=function(t){switch(this._setCurrentTime(t),this._keyFrameCount){case 0:break;case 1:this._currentFrame=this._timeline.frames[0],this._onArriveAtFrame(!1),this._onUpdateFrame(!1);break;default:this._currentFrame=this._timeline.frames[Math.floor(this._currentTime*this._timeToFrameSccale)],this._onArriveAtFrame(!1),this._onUpdateFrame(!1)}this._currentFrame=null},s.fadeIn=function(t,e,i,n){this._armature=t,this._animationState=e,this._timeline=i;var s=this==this._animationState._timeline;this._hasAsynchronyTimeline=s||this._animationState.clip.hasAsynchronyTimeline,this._keyFrameCount=this._timeline.frames.length,this._frameCount=this._animationState.clip.frameCount,this._position=this._animationState._position,this._duration=this._animationState._duration,this._clipDutation=this._animationState._clipDutation,this._timeScale=s?1:1/this._timeline.scale,this._timeOffset=s?0:this._timeline.offset,this._timeToFrameSccale=this._frameCount/this._clipDutation,this._onFadeIn(),this.setCurrentTime(n)},s.fadeOut=function(){},s.update=function(t){var e=this._currentTime;if(!this._isCompleted&&this._setCurrentTime(t)&&this._keyFrameCount){var i=this._keyFrameCount>1?Math.floor(this._currentTime*this._timeToFrameSccale):0,n=this._timeline.frames[i];if(this._currentFrame!=n)if(this._keyFrameCount>1){var s=this._currentFrame;if(this._currentFrame=n,this._isReverse)for(;s!=n;){if(!s){var a=Math.floor(e*this._timeToFrameSccale);s=this._timeline.frames[a]}this._onCrossFrame(s),s=s.prev}else for(;s!=n;){if(s)s=s.next;else{var a=Math.floor(e*this._timeToFrameSccale);s=this._timeline.frames[a]}this._onCrossFrame(s)}this._onArriveAtFrame(!0)}else this._currentFrame=n,this._onCrossFrame(this._currentFrame),this._onArriveAtFrame(!0);this._onUpdateFrame(!0)}},i}(t.BaseObject);t.TimelineState=e,egret.registerClass(e,"dragonBones.TimelineState");var i=function(e){function i(){e.call(this)}__extends(i,e);var n=(__define,i),s=n.prototype;return i._getEasingValue=function(t,e){var i=1;if(e>2)return t;if(e>1)i=.5*(1-Math.cos(t*Math.PI)),e-=1;else if(e>0)i=1-Math.pow(1-t,2);else if(e>=-1)e*=-1,i=Math.pow(t,2);else{if(!(e>=-2))return t;e*=-1,i=Math.acos(1-2*t)/Math.PI,e-=1}return(i-t)*e+t},i._getCurveEasingValue=function(t,e){for(var i=0,n=0,s=0,a=e.length;a>s;s+=2)if(i=e[s],n=e[s+1],i>=t){if(0==s)return n*t/i;var r=e[s-2],o=e[s-1];return o+(n-o)*(t-r)/(i-r)}return n+(1-n)*(t-i)/(1-i)},s._onClear=function(){e.prototype._onClear.call(this),this._tweenProgress=0,this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null},s._onArriveAtFrame=function(e){this._tweenEasing=this._currentFrame.tweenEasing,this._curve=this._currentFrame.curve,(1==this._keyFrameCount||this._currentFrame.next==this._timeline.frames[0]&&(this._tweenEasing!=t.DragonBones.NO_TWEEN||this._curve)&&this._animationState.playTimes>0&&this._animationState.currentPlayTimes==this._animationState.playTimes-1)&&(this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null)},s._onUpdateFrame=function(e){this._tweenEasing!=t.DragonBones.NO_TWEEN&&this._currentFrame.duration>0?(this._tweenProgress=(this._currentTime-this._currentFrame.position+this._position)/this._currentFrame.duration,0!=this._tweenEasing&&(this._tweenProgress=i._getEasingValue(this._tweenProgress,this._tweenEasing))):this._curve?(this._tweenProgress=(this._currentTime-this._currentFrame.position+this._position)/this._currentFrame.duration,this._tweenProgress=i._getCurveEasingValue(this._tweenProgress,this._curve)):this._tweenProgress=0},s._updateExtensionKeyFrame=function(t,e,i){var n=0;if(t.type==e.type)for(var s=0,a=t.tweens.length;a>s;++s){var r=e.tweens[s]-t.tweens[s];i.tweens[s]=r,0!=r&&(n=2)}if(0==n){i.type!=t.type&&(n=1,i.type=t.type),i.tweens.length!=t.tweens.length&&(n=1,i.tweens.length=t.tweens.length),i.keys.length!=t.keys.length&&(n=1,i.keys.length=t.keys.length);for(var s=0,a=t.keys.length;a>s;++s){var o=t.keys[s];i.keys[s]!=o&&(n=1,i.keys[s]=o)}}return n},i}(e);t.TweenTimelineState=i,egret.registerClass(i,"dragonBones.TweenTimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this)}__extends(i,e);var n=(__define,i),s=n.prototype;return i.toString=function(){return"[Class dragonBones.AnimationTimelineState]"},s._onClear=function(){e.prototype._onClear.call(this),this._isStarted=!1},s.update=function(i){var n=this._currentPlayTimes,s=this._armature._display;if(!this._isStarted&&0!=i&&(this._isStarted=!0,s.hasEvent(t.EventObject.START))){var a=t.BaseObject.borrowObject(t.EventObject);a.animationState=this._animationState,this._armature._bufferEvent(a,t.EventObject.START)}if(e.prototype.update.call(this,i),n!=this._currentPlayTimes){var r=this._isCompleted?t.EventObject.COMPLETE:t.EventObject.LOOP_COMPLETE;if(s.hasEvent(r)){var a=t.BaseObject.borrowObject(t.EventObject);a.animationState=this._animationState,this._armature._bufferEvent(a,r)}}},i}(t.TimelineState);t.AnimationTimelineState=e,egret.registerClass(e,"dragonBones.AnimationTimelineState");var i=function(e){function i(){e.call(this),this._transform=new t.Transform,this._currentTransform=new t.Transform,this._durationTransform=new t.Transform}__extends(i,e);var n=(__define,i),s=n.prototype;return i.toString=function(){return"[Class dragonBones.BoneTimelineState]"},s._onClear=function(){e.prototype._onClear.call(this),this.bone=null,this._tweenTransform=0,this._tweenRotate=0,this._tweenScale=0,this._boneTransform=null,this._originTransform=null,this._transform.identity(),this._currentTransform.identity(),this._durationTransform.identity()},s._onFadeIn=function(){this._originTransform=this._timeline.originTransform,this._boneTransform=this.bone._animationPose},s._onArriveAtFrame=function(i){if(e.prototype._onArriveAtFrame.call(this,i),this._currentTransform.copyFrom(this._currentFrame.transform),this._tweenTransform=1,this._tweenRotate=1,this._tweenScale=1,this._keyFrameCount>1&&(this._tweenEasing!=t.DragonBones.NO_TWEEN||this._curve)){var n=this._currentFrame.next,s=n.transform;this._durationTransform.x=s.x-this._currentTransform.x,this._durationTransform.y=s.y-this._currentTransform.y,(0!=this._durationTransform.x||0!=this._durationTransform.y)&&(this._tweenTransform=2);var a=this._currentFrame.tweenRotate;if(a==a){if(a)if(a>0?s.skewY>=this._currentTransform.skewY:s.skewY<=this._currentTransform.skewY){var r=a>0?a-1:a+1;this._durationTransform.skewX=s.skewX-this._currentTransform.skewX+t.DragonBones.PI_D*r,this._durationTransform.skewY=s.skewY-this._currentTransform.skewY+t.DragonBones.PI_D*r}else this._durationTransform.skewX=s.skewX-this._currentTransform.skewX+t.DragonBones.PI_D*a,this._durationTransform.skewY=s.skewY-this._currentTransform.skewY+t.DragonBones.PI_D*a;else this._durationTransform.skewX=t.Transform.normalizeRadian(s.skewX-this._currentTransform.skewX),this._durationTransform.skewY=t.Transform.normalizeRadian(s.skewY-this._currentTransform.skewY);(0!=this._durationTransform.skewX||0!=this._durationTransform.skewY)&&(this._tweenRotate=2)}else this._durationTransform.skewX=0,this._durationTransform.skewY=0;this._currentFrame.tweenScale?(this._durationTransform.scaleX=s.scaleX-this._currentTransform.scaleX,this._durationTransform.scaleY=s.scaleY-this._currentTransform.scaleY,(0!=this._durationTransform.scaleX||0!=this._durationTransform.scaleY)&&(this._tweenScale=2)):(this._durationTransform.scaleX=0,this._durationTransform.scaleY=0)}else this._durationTransform.x=0,this._durationTransform.y=0,this._durationTransform.skewX=0,this._durationTransform.skewY=0,this._durationTransform.scaleX=0,this._durationTransform.scaleY=0},s._onUpdateFrame=function(t){(this._tweenTransform||this._tweenRotate||this._tweenScale)&&(e.prototype._onUpdateFrame.call(this,t),this._tweenTransform&&(1==this._tweenTransform&&(this._tweenTransform=0),this._animationState.additiveBlending?(this._transform.x=this._currentTransform.x+this._durationTransform.x*this._tweenProgress,this._transform.y=this._currentTransform.y+this._durationTransform.y*this._tweenProgress):(this._transform.x=this._originTransform.x+this._currentTransform.x+this._durationTransform.x*this._tweenProgress,this._transform.y=this._originTransform.y+this._currentTransform.y+this._durationTransform.y*this._tweenProgress)),this._tweenRotate&&(1==this._tweenRotate&&(this._tweenRotate=0),this._animationState.additiveBlending?(this._transform.skewX=this._currentTransform.skewX+this._durationTransform.skewX*this._tweenProgress,this._transform.skewY=this._currentTransform.skewY+this._durationTransform.skewY*this._tweenProgress):(this._transform.skewX=this._originTransform.skewX+this._currentTransform.skewX+this._durationTransform.skewX*this._tweenProgress,this._transform.skewY=this._originTransform.skewY+this._currentTransform.skewY+this._durationTransform.skewY*this._tweenProgress)),this._tweenScale&&(1==this._tweenScale&&(this._tweenScale=0),this._animationState.additiveBlending?(this._transform.scaleX=this._currentTransform.scaleX+this._durationTransform.scaleX*this._tweenProgress,this._transform.scaleY=this._currentTransform.scaleY+this._durationTransform.scaleY*this._tweenProgress):(this._transform.scaleX=this._originTransform.scaleX*(this._currentTransform.scaleX+this._durationTransform.scaleX*this._tweenProgress),this._transform.scaleY=this._originTransform.scaleY*(this._currentTransform.scaleY+this._durationTransform.scaleY*this._tweenProgress))),this.bone.invalidUpdate())},s.fadeOut=function(){this._transform.skewX=t.Transform.normalizeRadian(this._transform.skewX),this._transform.skewY=t.Transform.normalizeRadian(this._transform.skewY)},s.update=function(t){e.prototype.update.call(this,t);var i=this._animationState._weightResult;if(i>0){0==this.bone._blendIndex?(this._boneTransform.x=this._transform.x*i,this._boneTransform.y=this._transform.y*i,this._boneTransform.skewX=this._transform.skewX*i,this._boneTransform.skewY=this._transform.skewY*i,this._boneTransform.scaleX=(this._transform.scaleX-1)*i+1,this._boneTransform.scaleY=(this._transform.scaleY-1)*i+1):(this._boneTransform.x+=this._transform.x*i,this._boneTransform.y+=this._transform.y*i,this._boneTransform.skewX+=this._transform.skewX*i,this._boneTransform.skewY+=this._transform.skewY*i,this._boneTransform.scaleX+=(this._transform.scaleX-1)*i,this._boneTransform.scaleY+=(this._transform.scaleY-1)*i),this.bone._blendIndex++;var n=this._animationState._fadeProgress;1>n&&this.bone.invalidUpdate()}},i}(t.TweenTimelineState);t.BoneTimelineState=i,egret.registerClass(i,"dragonBones.BoneTimelineState");var n=function(e){function i(){e.call(this),this._color=new t.ColorTransform,this._durationColor=new t.ColorTransform}__extends(i,e);var n=(__define,i),s=n.prototype;return i.toString=function(){return"[Class dragonBones.SlotTimelineState]"},s._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this._colorDirty=!1,this._tweenColor=0,this._slotColor=null,this._color.alphaMultiplier=1,this._color.redMultiplier=1,this._color.greenMultiplier=1,this._color.blueMultiplier=1,this._color.alphaOffset=0,this._color.redOffset=0,this._color.greenOffset=0,this._color.blueOffset=0,this._durationColor.alphaMultiplier=1,this._durationColor.redMultiplier=1,this._durationColor.greenMultiplier=1,this._durationColor.blueMultiplier=1,this._durationColor.alphaOffset=0,this._durationColor.redOffset=0,this._durationColor.greenOffset=0,this._durationColor.blueOffset=0},s._onFadeIn=function(){this._slotColor=this.slot._colorTransform},s._onArriveAtFrame=function(i){if(e.prototype._onArriveAtFrame.call(this,i),this._animationState._isDisabled(this.slot))return this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null,void(this._tweenColor=0);if(this.slot._displayDataSet){var n=this._currentFrame.displayIndex;this.slot.displayIndex>=0&&n>=0?this.slot._displayDataSet.displays.length>1&&this.slot._setDisplayIndex(n):this.slot._setDisplayIndex(n),this.slot._updateMeshData(!0)}if(this._currentFrame.displayIndex>=0){this._tweenColor=0;var s=this._currentFrame.color;if(this._keyFrameCount>1&&(this._tweenEasing!=t.DragonBones.NO_TWEEN||this._curve)){var a=this._currentFrame.next,r=a.color;s!=r&&a.displayIndex>=0&&(this._durationColor.alphaMultiplier=r.alphaMultiplier-s.alphaMultiplier,this._durationColor.redMultiplier=r.redMultiplier-s.redMultiplier,this._durationColor.greenMultiplier=r.greenMultiplier-s.greenMultiplier,this._durationColor.blueMultiplier=r.blueMultiplier-s.blueMultiplier,this._durationColor.alphaOffset=r.alphaOffset-s.alphaOffset,this._durationColor.redOffset=r.redOffset-s.redOffset,this._durationColor.greenOffset=r.greenOffset-s.greenOffset,this._durationColor.blueOffset=r.blueOffset-s.blueOffset,(0!=this._durationColor.alphaMultiplier||0!=this._durationColor.redMultiplier||0!=this._durationColor.greenMultiplier||0!=this._durationColor.blueMultiplier||0!=this._durationColor.alphaOffset||0!=this._durationColor.redOffset||0!=this._durationColor.greenOffset||0!=this._durationColor.blueOffset)&&(this._tweenColor=2))
}0==this._tweenColor&&(this._durationColor.alphaMultiplier=s.alphaMultiplier-this._slotColor.alphaMultiplier,this._durationColor.redMultiplier=s.redMultiplier-this._slotColor.redMultiplier,this._durationColor.greenMultiplier=s.greenMultiplier-this._slotColor.greenMultiplier,this._durationColor.blueMultiplier=s.blueMultiplier-this._slotColor.blueMultiplier,this._durationColor.alphaOffset=s.alphaOffset-this._slotColor.alphaOffset,this._durationColor.redOffset=s.redOffset-this._slotColor.redOffset,this._durationColor.greenOffset=s.greenOffset-this._slotColor.greenOffset,this._durationColor.blueOffset=s.blueOffset-this._slotColor.blueOffset,(0!=this._durationColor.alphaMultiplier||0!=this._durationColor.redMultiplier||0!=this._durationColor.greenMultiplier||0!=this._durationColor.blueMultiplier||0!=this._durationColor.alphaOffset||0!=this._durationColor.redOffset||0!=this._durationColor.greenOffset||0!=this._durationColor.blueOffset)&&(this._tweenColor=1))}else this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null,this._tweenColor=0},s._onUpdateFrame=function(t){if(e.prototype._onUpdateFrame.call(this,t),this._tweenColor){1==this._tweenColor&&(this._tweenColor=0);var i=this._currentFrame.color;this._color.alphaMultiplier=i.alphaMultiplier+this._durationColor.alphaMultiplier*this._tweenProgress,this._color.redMultiplier=i.redMultiplier+this._durationColor.redMultiplier*this._tweenProgress,this._color.greenMultiplier=i.greenMultiplier+this._durationColor.greenMultiplier*this._tweenProgress,this._color.blueMultiplier=i.blueMultiplier+this._durationColor.blueMultiplier*this._tweenProgress,this._color.alphaOffset=i.alphaOffset+this._durationColor.alphaOffset*this._tweenProgress,this._color.redOffset=i.redOffset+this._durationColor.redOffset*this._tweenProgress,this._color.greenOffset=i.greenOffset+this._durationColor.greenOffset*this._tweenProgress,this._color.blueOffset=i.blueOffset+this._durationColor.blueOffset*this._tweenProgress,this._colorDirty=!0}},s.fadeOut=function(){this._tweenColor=0},s.update=function(t){if(e.prototype.update.call(this,t),0!=this._tweenColor||this._colorDirty){var i=this._animationState._weightResult;if(i>0){var n=this._animationState._fadeProgress;1>n?(this._slotColor.alphaMultiplier+=(this._color.alphaMultiplier-this._slotColor.alphaMultiplier)*n,this._slotColor.redMultiplier+=(this._color.redMultiplier-this._slotColor.redMultiplier)*n,this._slotColor.greenMultiplier+=(this._color.greenMultiplier-this._slotColor.greenMultiplier)*n,this._slotColor.blueMultiplier+=(this._color.blueMultiplier-this._slotColor.blueMultiplier)*n,this._slotColor.alphaOffset+=(this._color.alphaOffset-this._slotColor.alphaOffset)*n,this._slotColor.redOffset+=(this._color.redOffset-this._slotColor.redOffset)*n,this._slotColor.greenOffset+=(this._color.greenOffset-this._slotColor.greenOffset)*n,this._slotColor.blueOffset+=(this._color.blueOffset-this._slotColor.blueOffset)*n,this.slot._colorDirty=!0):this._colorDirty&&(this._colorDirty=!1,this._slotColor.alphaMultiplier=this._color.alphaMultiplier,this._slotColor.redMultiplier=this._color.redMultiplier,this._slotColor.greenMultiplier=this._color.greenMultiplier,this._slotColor.blueMultiplier=this._color.blueMultiplier,this._slotColor.alphaOffset=this._color.alphaOffset,this._slotColor.redOffset=this._color.redOffset,this._slotColor.greenOffset=this._color.greenOffset,this._slotColor.blueOffset=this._color.blueOffset,this.slot._colorDirty=!0)}}},i}(t.TweenTimelineState);t.SlotTimelineState=n,egret.registerClass(n,"dragonBones.SlotTimelineState");var s=function(e){function i(){e.call(this),this._ffdVertices=[]}__extends(i,e);var n=(__define,i),s=n.prototype;return i.toString=function(){return"[Class dragonBones.FFDTimelineState]"},s._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this._tweenFFD=0,this._slotFFDVertices=null,this._durationFFDFrame&&(this._durationFFDFrame.returnToPool(),this._durationFFDFrame=null),this._ffdVertices.length&&(this._ffdVertices.length=0)},s._onFadeIn=function(){this._slotFFDVertices=this.slot._ffdVertices,this._durationFFDFrame=t.BaseObject.borrowObject(t.ExtensionFrameData),this._durationFFDFrame.tweens.length=this._slotFFDVertices.length,this._ffdVertices.length=this._slotFFDVertices.length;for(var e=0,i=this._durationFFDFrame.tweens.length;i>e;++e)this._durationFFDFrame.tweens[e]=0;for(var e=0,i=this._ffdVertices.length;i>e;++e)this._ffdVertices[e]=0},s._onArriveAtFrame=function(i){if(e.prototype._onArriveAtFrame.call(this,i),this._tweenFFD=0,(this._tweenEasing!=t.DragonBones.NO_TWEEN||this._curve)&&(this._tweenFFD=this._updateExtensionKeyFrame(this._currentFrame,this._currentFrame.next,this._durationFFDFrame)),0==this._tweenFFD)for(var n=this._currentFrame.tweens,s=0,a=n.length;a>s;++s)if(this._slotFFDVertices[s]!=n[s]){this._tweenFFD=1;break}},s._onUpdateFrame=function(t){if(e.prototype._onUpdateFrame.call(this,t),0!=this._tweenFFD){1==this._tweenFFD&&(this._tweenFFD=0);for(var i=this._currentFrame.tweens,n=this._durationFFDFrame.tweens,s=0,a=i.length;a>s;++s)this._ffdVertices[s]=i[s]+n[s]*this._tweenProgress;this.slot._ffdDirty=!0}},s.update=function(t){e.prototype.update.call(this,t);var i=this._animationState._weightResult;if(i>0){if(0==this.slot._blendIndex)for(var n=0,s=this._ffdVertices.length;s>n;++n)this._slotFFDVertices[n]=this._ffdVertices[n]*i;else for(var n=0,s=this._ffdVertices.length;s>n;++n)this._slotFFDVertices[n]+=this._ffdVertices[n]*i;this.slot._blendIndex++;var a=this._animationState._fadeProgress;1>a&&(this.slot._ffdDirty=!0)}},i}(t.TweenTimelineState);t.FFDTimelineState=s,egret.registerClass(s,"dragonBones.FFDTimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.time=(new Date).getTime()/t.DragonBones.SECOND_TO_MILLISECOND,this.timeScale=1,this._animatebles=[]}var i=__define,n=e,s=n.prototype;return i(e,"clock",function(){return e._clock||(e._clock=new e),e._clock}),s.advanceTime=function(e){if(e!=e&&(e=0),0>e&&(e=(new Date).getTime()/t.DragonBones.SECOND_TO_MILLISECOND-this.time),e*=this.timeScale,0>e?this.time-=e:this.time+=e,e){for(var i=0,n=0,s=this._animatebles.length;s>i;++i){var a=this._animatebles[i];a?(a.advanceTime(e),n>0&&(this._animatebles[i-n]=a)):n++}if(n>0){for(s=this._animatebles.length;s>i;++i){var a=this._animatebles[i];a?this._animatebles[i-n]=a:n++}this._animatebles.length-=n}}},s.contains=function(t){return this._animatebles.indexOf(t)>=0},s.add=function(t){t&&this._animatebles.indexOf(t)<0&&this._animatebles.push(t)},s.remove=function(t){var e=this._animatebles.indexOf(t);e>=0&&(this._animatebles[e]=null)},s.clear=function(){for(var t=0,e=this._animatebles.length;e>t;++t)this._animatebles[t]=null},e._clock=null,e}();t.WorldClock=e,egret.registerClass(e,"dragonBones.WorldClock",["dragonBones.IAnimateble"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this._bones=[],this._slots=[],this._events=[],this.enableCache=!1}__extends(i,e);var n=__define,s=i,a=s.prototype;return i.toString=function(){return"[Class dragonBones.Armature]"},a._onClear=function(){if(this.userData=null,this._bonesDirty=!1,this._cacheFrameIndex=-1,this._delayAdvanceTime=-1,this._armatureData=null,this._skinData=null,this._animation&&(this._animation.returnToPool(),this._animation=null),this._display&&(this._display._onClear(),this._display=null),this._parent=null,this._action=null,this._replacedTexture=null,this._delayDispose=!1,this._lockDispose=!1,this._lockActionAndEvent=!1,this._slotsDirty=!1,this._bones.length){for(var t=0,e=this._bones.length;e>t;++t)this._bones[t].returnToPool();this._bones.length=0}if(this._slots.length){for(var t=0,e=this._slots.length;e>t;++t)this._slots[t].returnToPool();this._slots.length=0}if(this._events.length){for(var t=0,e=this._events.length;e>t;++t)this._events[t].returnToPool();this._events.length=0}},a._sortBones=function(){var t=this._bones.length;if(t){var e=this._bones.concat(),i=0,n=0;for(this._bones.length=0;t>n;){var s=e[i++];i>=t&&(i=0),this._bones.indexOf(s)>=0||s.parent&&this._bones.indexOf(s.parent)<0||s.ik&&this._bones.indexOf(s.ik)<0||(s.ik&&s.ikChain>0&&s.ikChainIndex==s.ikChain?this._bones.splice(this._bones.indexOf(s.parent)+1,0,s):this._bones.push(s),n++)}}},a._sortSlots=function(){},a._addBoneToBoneList=function(t){this._bones.indexOf(t)<0&&(this._bonesDirty=!0,this._bones[this._bones.length]=t,this._animation._timelineStateDirty=!0)},a._removeBoneFromBoneList=function(t){var e=this._bones.indexOf(t);e>=0&&(this._bones.splice(e,1),this._animation._timelineStateDirty=!0)},a._addSlotToSlotList=function(t){this._slots.indexOf(t)<0&&(this._slotsDirty=!0,this._slots[this._slots.length]=t,this._animation._timelineStateDirty=!0)},a._removeSlotFromSlotList=function(t){var e=this._slots.indexOf(t);e>=0&&(this._slots.splice(e,1),this._animation._timelineStateDirty=!0)},a._bufferEvent=function(t,e){t.type=e,t.armature=this,this._events.push(t)},a.dispose=function(){this._delayDispose=!0,this._lockDispose||this.returnToPool()},a.advanceTime=function(e){this._lockDispose=!0;var n=e*this._animation.timeScale;this._animation._advanceTime(n),this._bonesDirty&&(this._bonesDirty=!1,this._sortBones()),this._slotsDirty&&(this._slotsDirty=!1,this._sortSlots());for(var s=0,a=this._bones.length;a>s;++s)this._bones[s]._update(this._cacheFrameIndex);for(var s=0,a=this._slots.length;a>s;++s){var r=this._slots[s];r._update(this._cacheFrameIndex);var o=r.childArmature;o&&(r.inheritAnimation?o.advanceTime(n):o.advanceTime(e))}if(!this._lockActionAndEvent){if(this._lockActionAndEvent=!0,this._action){switch(this._action.type){case 0:this._animation.play(this._action.data[0],this._action.data[1]);break;case 1:this._animation.stop(this._action.data[0]);break;case 2:this._animation.gotoAndPlayByTime(this._action.data[0],this._action.data[1],this._action.data[2]);break;case 3:this._animation.gotoAndStopByTime(this._action.data[0],this._action.data[1]);break;case 4:this._animation.fadeIn(this._action.data[0],this._action.data[1],this._action.data[2]);break;case 5:}this._action=null}if(this._events.length>0){for(var s=0,a=this._events.length;a>s;++s){var l=this._events[s];i._soundEventManager&&l.type==t.EventObject.SOUND_EVENT?i._soundEventManager._dispatchEvent(l):this._display._dispatchEvent(l),l.returnToPool()}this._events.length=0}this._lockActionAndEvent=!1}if(this._lockDispose=!1,this._delayDispose)this.returnToPool();else if(this._delayAdvanceTime>=0){var h=this._delayAdvanceTime;this._delayAdvanceTime=-1,this.advanceTime(h)}},a.invalidUpdate=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=!1),t){var i=this.getBone(t);if(i&&(i.invalidUpdate(),e))for(var n=0,s=this._slots.length;s>n;++n){var a=this._slots[n];a.parent==i&&a.invalidUpdate()}}else{for(var n=0,s=this._bones.length;s>n;++n)this._bones[n].invalidUpdate();if(e)for(var n=0,s=this._slots.length;s>n;++n)this._slots[n].invalidUpdate()}},a.getSlot=function(t){for(var e=0,i=this._slots.length;i>e;++e){var n=this._slots[e];if(n.name==t)return n}return null},a.getSlotByDisplay=function(t){if(t)for(var e=0,i=this._slots.length;i>e;++e){var n=this._slots[e];if(n.display==t)return n}return null},a.addSlot=function(t,e){var i=this.getBone(e);if(!i)throw new Error;t._setArmature(this),t._setParent(i)},a.removeSlot=function(t){if(!t||t.armature!=this)throw new Error;t._setParent(null),t._setArmature(null)},a.getBone=function(t){for(var e=0,i=this._bones.length;i>e;++e){var n=this._bones[e];if(n.name==t)return n}return null},a.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return e?e.parent:null},a.addBone=function(t,e){if(void 0===e&&(e=null),!t)throw new Error;t._setArmature(this),t._setParent(e?this.getBone(e):null)},a.removeBone=function(t){if(!t||t.armature!=this)throw new Error;t._setParent(null),t._setArmature(null)},a.replaceTexture=function(t){this._replacedTexture=t;for(var e=0,i=this._slots.length;i>e;++e)this._slots[e].invalidUpdate()},a.getBones=function(){return this._bones},a.getSlots=function(){return this._slots},n(a,"name",function(){return this._armatureData?this._armatureData.name:null}),n(a,"armatureData",function(){return this._armatureData}),n(a,"display",function(){return this._display}),n(a,"parent",function(){return this._parent}),n(a,"animation",function(){return this._animation}),n(a,"cacheFrameRate",function(){return this._armatureData.cacheFrameRate},function(t){this._armatureData.cacheFrameRate!=t&&this._armatureData.cacheFrames(t)}),a.enableAnimationCache=function(t){this.cacheFrameRate=t},a.hasEventListener=function(t){this._display.hasEvent(t)},a.addEventListener=function(t,e,i){this._display.addEvent(t,e,i)},a.removeEventListener=function(t,e,i){this._display.removeEvent(t,e,i)},a.getDisplay=function(){return this._display},i._soundEventManager=null,i}(t.BaseObject);t.Armature=e,egret.registerClass(e,"dragonBones.Armature",["dragonBones.IAnimateble"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this.global=new t.Transform,this.origin=new t.Transform,this.offset=new t.Transform,this._globalTransformMatrix=new t.Matrix}__extends(i,e);var n=__define,s=i,a=s.prototype;return a._onClear=function(){this.userData=null,this.name=null,this.globalTransformMatrix=this._globalTransformMatrix,this.global.identity(),this.origin.identity(),this.offset.identity(),this._armature=null,this._parent=null,this._globalTransformMatrix.identity()},a._setArmature=function(t){this._armature=t},a._setParent=function(t){this._parent=t},n(a,"armature",function(){return this._armature}),n(a,"parent",function(){return this._parent}),i}(t.BaseObject);t.TransformObject=e,egret.registerClass(e,"dragonBones.TransformObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this._animationPose=new t.Transform,this._bones=[],this._slots=[]}__extends(i,e);var n=__define,s=i,a=s.prototype;return i.toString=function(){return"[Class dragonBones.Bone]"},a._onClear=function(){e.prototype._onClear.call(this),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.ikBendPositive=!1,this.ikWeight=0,this.length=0,this._transformDirty=2,this._blendIndex=0,this._cacheFrames=null,this._animationPose.identity(),this._visible=!0,this._ikChain=0,this._ikChainIndex=0,this._ik=null,this._bones.length&&(this._bones.length=0),this._slots.length&&(this._slots.length=0)},a._updateGlobalTransformMatrix=function(){if(this._parent){var t=this._parent.global.skewY,e=this._parent.globalTransformMatrix;if(this.inheritScale)this.inheritRotation||(this.global.skewX-=t,this.global.skewY-=t),this.global.toMatrix(this.globalTransformMatrix),this.globalTransformMatrix.concat(e),this.inheritTranslation||(this.globalTransformMatrix.tx=this.global.x,this.globalTransformMatrix.ty=this.global.y),this.global.fromMatrix(this.globalTransformMatrix);else{if(this.inheritTranslation){var i=this.global.x,n=this.global.y;this.global.x=e.a*i+e.c*n+e.tx,this.global.y=e.d*n+e.b*i+e.ty}this.inheritRotation&&(this.global.skewX+=t,this.global.skewY+=t),this.global.toMatrix(this.globalTransformMatrix)}}else this.global.toMatrix(this.globalTransformMatrix)},a._computeIKA=function(){var t=this._ik.global,e=this.globalTransformMatrix.a*this.length,i=this.globalTransformMatrix.b*this.length,n=(Math.atan2(t.y-this.global.y,t.x-this.global.x)+this.offset.skewY-2*this.global.skewY+Math.atan2(i,e))*this.ikWeight;this.global.skewX+=n,this.global.skewY+=n,this.global.toMatrix(this.globalTransformMatrix)},a._computeIKB=function(){var t=this._parent.global,e=this._ik.global,i=this.globalTransformMatrix.a*this.length,n=this.globalTransformMatrix.b*this.length,s=i*i+n*n,a=Math.sqrt(s),r=this.global.x-t.x,o=this.global.y-t.y,l=r*r+o*o,h=Math.sqrt(l);r=e.x-t.x,o=e.y-t.y;var _=r*r+o*o,u=Math.sqrt(_),f=0;if(u>=a+h||h>=u+a||a>=u+h)f=Math.atan2(e.y-t.y,e.x-t.x)+this._parent.offset.skewY,u>=a+h||a>h&&(f+=Math.PI);else{var m=(l-s+_)/(2*_),d=Math.sqrt(l-m*m*_)/u,c=t.x+r*m,g=t.y+o*m,p=-o*d,v=r*d;this.ikBendPositive?(this.global.x=c-p,this.global.y=g-v):(this.global.x=c+p,this.global.y=g+v),f=Math.atan2(this.global.y-t.y,this.global.x-t.x)+this._parent.offset.skewY}f=(f-t.skewY)*this.ikWeight,t.skewX+=f,t.skewY+=f,t.toMatrix(this._parent.globalTransformMatrix);var T=(Math.atan2(e.y-this.global.y,e.x-this.global.x)+this.offset.skewY-2*this.global.skewY+Math.atan2(n,i))*this.ikWeight;this.global.skewX+=T,this.global.skewY+=T,this.global.x=t.x+Math.cos(t.skewY)*h,this.global.y=t.y+Math.sin(t.skewY)*h,this.global.toMatrix(this.globalTransformMatrix)},a._setArmature=function(t){if(this._armature!=t){this._ik=null;var e=null,i=null;if(this._armature&&(e=this.getSlots(),i=this.getBones(),this._armature._removeBoneFromBoneList(this)),this._armature=t,this._armature&&this._armature._addBoneToBoneList(this),e)for(var n=0,s=e.length;s>n;++n){var a=e[n];a.parent==this&&a._setArmature(this._armature)}if(i)for(var n=0,s=i.length;s>n;++n){var r=i[n];r.parent==this&&r._setArmature(this._armature)}}},a._setIK=function(t,e,i){if(t){if(e==i){var n=this._parent;if(e&&n?e=1:(e=0,i=0,n=this),n==t||n.contains(t))t=null,e=0,i=0;else for(var s=t;s.ik&&s.ikChain;){if(n.contains(s.ik)){t=null,e=0,i=0;break}s=s.parent}}}else e=0,i=0;this._ik=t,this._ikChain=e,this._ikChainIndex=i,this._armature&&(this._armature._bonesDirty=!0)},a._update=function(e){if(this._blendIndex=0,e>=0){var i=this._cacheFrames[e];this.globalTransformMatrix==i?this._transformDirty=0:i?(this._transformDirty=2,this.globalTransformMatrix=i):2==this._transformDirty||this._parent&&0!=this._parent._transformDirty||this._ik&&this.ikWeight>0&&0!=this._ik._transformDirty?(this._transformDirty=2,this.globalTransformMatrix=this._globalTransformMatrix):this.globalTransformMatrix!=this._globalTransformMatrix?(this._transformDirty=0,this._cacheFrames[e]=this.globalTransformMatrix):(this._transformDirty=1,this.globalTransformMatrix=this._globalTransformMatrix)}else(2==this._transformDirty||this._parent&&this._parent._transformDirty||this._ik&&this.ikWeight>0&&0!=this._ik._transformDirty)&&(this._transformDirty=2,this.globalTransformMatrix=this._globalTransformMatrix);0!=this._transformDirty&&(2==this._transformDirty?this._transformDirty=1:this._transformDirty=0,this.globalTransformMatrix==this._globalTransformMatrix&&(this.global.x=this.origin.x+this.offset.x+this._animationPose.x,this.global.y=this.origin.y+this.offset.y+this._animationPose.y,this.global.skewX=this.origin.skewX+this.offset.skewX+this._animationPose.skewX,this.global.skewY=this.origin.skewY+this.offset.skewY+this._animationPose.skewY,this.global.scaleX=this.origin.scaleX*this.offset.scaleX*this._animationPose.scaleX,this.global.scaleY=this.origin.scaleY*this.offset.scaleY*this._animationPose.scaleY,this._updateGlobalTransformMatrix(),this._ik&&this._ikChainIndex==this._ikChain&&this.ikWeight>0&&(this.inheritTranslation&&this._ikChain>0&&this._parent?this._computeIKB():this._computeIKA()),e>=0&&(this.globalTransformMatrix=t.BoneTimelineData.cacheFrame(this._cacheFrames,e,this._globalTransformMatrix))))},a.invalidUpdate=function(){this._transformDirty=2},a.contains=function(t){if(t){if(t==this)return!1;for(var e=t;e!=this&&e;)e=e.parent;return e==this}return!1},a.getBones=function(){this._bones.length=0;for(var t=this._armature.getBones(),e=0,i=t.length;i>e;++e){var n=t[e];n.parent==this&&this._bones.push(n)}return this._bones},a.getSlots=function(){this._slots.length=0;for(var t=this._armature.getSlots(),e=0,i=t.length;i>e;++e){var n=t[e];n.parent==this&&this._slots.push(n)}return this._slots},n(a,"ikChain",function(){return this._ikChain}),n(a,"ikChainIndex",function(){return this._ikChainIndex}),n(a,"ik",function(){return this._ik}),n(a,"visible",function(){return this._visible},function(t){if(this._visible!=t){this._visible=t;for(var e=this._armature.getSlots(),i=0,n=e.length;n>i;++i){var s=e[i];s._parent==this&&s._updateVisible()}}}),n(a,"slot",function(){for(var t=this._armature.getSlots(),e=0,i=t.length;i>e;++e){var n=t[e];if(n.parent==this)return n}return null}),i}(t.TransformObject);t.Bone=e,egret.registerClass(e,"dragonBones.Bone")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this._colorTransform=new t.ColorTransform,this._ffdVertices=[],this._replacedDisplayDataSet=[],this._localMatrix=new t.Matrix,this._displayList=[],this._meshBones=[]}__extends(i,e);var n=__define,s=i,a=s.prototype;return a._onClear=function(){e.prototype._onClear.call(this),this.inheritAnimation=!0,this.displayController=null,this._colorDirty=!1,this._ffdDirty=!1,this._blendIndex=0,this._zOrder=0,this._displayDataSet=null,this._meshData=null,this._cacheFrames=null,this._rawDisplay=null,this._meshDisplay=null,this._colorTransform.identity(),this._ffdVertices.length&&(this._ffdVertices.length=0),this._replacedDisplayDataSet.length&&(this._replacedDisplayDataSet.length=0),this._displayDirty=!1,this._blendModeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._displayIndex=0,this._blendMode=0,this._display=null,this._childArmature=null,this._localMatrix.identity(),this._displayList.length&&(this._displayList.length=0),this._meshBones.length&&(this._meshBones.length=0)},a._isMeshBonesUpdate=function(){for(var t=0,e=this._meshBones.length;e>t;++t)if(0!=this._meshBones[t]._transformDirty)return!0;return!1},a._updateDisplay=function(){var e=this._display||this._rawDisplay,i=this._childArmature;this._displayIndex>=0&&this._displayIndex<this._displayList.length?(this._display=this._displayList[this._displayIndex],this._display instanceof t.Armature?(this._childArmature=this._display,this._display=this._childArmature._display):this._childArmature=null):(this._display=null,this._childArmature=null);var n=this._display||this._rawDisplay;n!=e&&(this._onUpdateDisplay(),e?this._replaceDisplay(e):this._addDisplay(),this._blendModeDirty=!0,this._colorDirty=!0),this._displayDataSet&&this._displayIndex>=0&&this._displayIndex<this._displayDataSet.displays.length&&(this.origin.copyFrom(this._displayDataSet.displays[this._displayIndex].transform),this._originDirty=!0),this._updateMeshData(!1),(n==this._rawDisplay||n==this._meshDisplay)&&this._updateFrame(),this._childArmature!=i&&(i&&(i._parent=null,this.inheritAnimation&&i.animation.reset()),this._childArmature&&(this._childArmature._parent=this,this.inheritAnimation&&this._childArmature.animation.play()))},a._updateLocalTransformMatrix=function(){this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix)},a._updateGlobalTransformMatrix=function(){this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(this._parent.globalTransformMatrix),this.global.fromMatrix(this.globalTransformMatrix)},a._setArmature=function(t){this._armature!=t&&(this._armature&&this._armature._removeSlotFromSlotList(this),this._armature=t,this._onUpdateDisplay(),this._armature?(this._armature._addSlotToSlotList(this),this._addDisplay()):this._removeDisplay())},a._updateMeshData=function(t){var e=this._meshData;if(this._display==this._meshDisplay&&this._displayDataSet&&this._displayIndex>=0&&this._displayIndex<this._displayDataSet.displays.length?this._meshData=this._displayDataSet.displays[this._displayIndex].meshData:this._meshData=null,this._meshData!=e){if(this._meshData){if(this._meshData.skinned){this._meshBones.length=this._meshData.bones.length;for(var i=0,n=this._meshBones.length;n>i;++i)this._meshBones[i]=this._armature.getBone(this._meshData.bones[i].name);for(var s=0,i=0,n=this._meshData.boneIndices.length;n>i;++i)s+=this._meshData.boneIndices[i].length;this._ffdVertices.length=2*s}else this._meshBones.length=0,this._ffdVertices.length=this._meshData.vertices.length;for(var i=0,n=this._ffdVertices.length;n>i;++i)this._ffdVertices[i]=0;this._ffdDirty=!0}else this._meshBones.length=0,this._ffdVertices.length=0;t&&this._armature.animation._updateFFDTimelineStates()}},a._update=function(e){if(this._blendIndex=0,this._displayDirty&&(this._displayDirty=!1,this._updateDisplay()),this._display&&(this._blendModeDirty&&(this._blendModeDirty=!1,this._updateBlendMode()),this._colorDirty&&(this._colorDirty=!1,this._updateColor()),!this._meshData||((this._ffdDirty||this._meshData.skinned&&this._isMeshBonesUpdate())&&(this._ffdDirty=!1,this._updateMesh()),!this._meshData.skinned))){if(this._originDirty&&(this._originDirty=!1,this._transformDirty=!0,this._updateLocalTransformMatrix()),e>=0){var i=this._cacheFrames[e];this.globalTransformMatrix==i?this._transformDirty=!1:i?(this._transformDirty=!0,this.globalTransformMatrix=i):this._transformDirty||0!=this._parent._transformDirty?(this._transformDirty=!0,this.globalTransformMatrix=this._globalTransformMatrix):this.globalTransformMatrix!=this._globalTransformMatrix?(this._transformDirty=!1,this._cacheFrames[e]=this.globalTransformMatrix):(this._transformDirty=!0,this.globalTransformMatrix=this._globalTransformMatrix)}else(this._transformDirty||0!=this._parent._transformDirty)&&(this._transformDirty=!0,this.globalTransformMatrix=this._globalTransformMatrix);this._transformDirty&&(this._transformDirty=!1,this.globalTransformMatrix==this._globalTransformMatrix&&(this._updateGlobalTransformMatrix(),e>=0&&(this.globalTransformMatrix=t.SlotTimelineData.cacheFrame(this._cacheFrames,e,this._globalTransformMatrix))),this._updateTransform())}},a._setDisplayList=function(e){if(e&&e.length){this._displayList.length!=e.length&&(this._displayList.length=e.length);for(var i=0,n=this._displayList.length;n>i;++i){var s=e[i];s&&s!=this._rawDisplay&&!(s instanceof t.Armature)&&this._displayList.indexOf(s)<0&&this._initDisplay(s),this._displayList[i]=s}}else this._displayList.length&&(this._displayList.length=0);return this._displayIndex>=0&&this._displayIndex<this._displayList.length?this._displayDirty=this._display!=this._displayList[this._displayIndex]:this._displayDirty=null!=this._display,this._displayDirty},a._setDisplayIndex=function(t){return this._displayIndex==t?!1:(this._displayIndex=t,this._displayDirty=!0,this._displayDirty)},a._setBlendMode=function(t){return this._blendMode==t?!1:(this._blendMode=t,this._blendModeDirty=!0,!0)},a._setColor=function(t){return this._colorTransform.copyFrom(t),this._colorDirty=!0,!0},a.invalidUpdate=function(){this._displayDirty=!0},n(a,"rawDisplay",function(){return this._rawDisplay}),n(a,"MeshDisplay",function(){return this._meshDisplay}),n(a,"displayIndex",function(){return this._displayIndex},function(t){this._setDisplayIndex(t)&&this._update(-1)}),n(a,"displayList",function(){return this._displayList.concat()},function(e){var i=this._displayList.concat(),n=[];this._setDisplayList(e)&&this._update(-1);for(var s=0,a=i.length;a>s;++s){var r=i[s];r!=this._rawDisplay&&this._displayList.indexOf(r)<0&&n.indexOf(r)<0&&n.push(r)}for(var s=0,a=n.length;a>s;++s){var r=n[s];r instanceof t.Armature?r.returnToPool():this._disposeDisplay(r)}}),n(a,"display",function(){return this._display},function(t){if(this._display!=t){var e=this._displayList.length;if(this._displayIndex<0&&0==e&&(this._displayIndex=0),!(this._displayIndex<0)){var i=this.displayList;e<=this._displayIndex&&(i.length=this._displayIndex+1),i[this._displayIndex]=t,this.displayList=i}}}),n(a,"childArmature",function(){return this._childArmature},function(t){this._childArmature!=t&&(this.display=t)}),a.getDisplay=function(){return this._display},a.setDisplay=function(t){this.display=t},i}(t.TransformObject);t.Slot=e,egret.registerClass(e,"dragonBones.Slot")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.PI_D=2*Math.PI,t.PI_H=Math.PI/2,t.PI_Q=Math.PI/4,t.ANGLE_TO_RADIAN=Math.PI/180,t.RADIAN_TO_ANGLE=180/Math.PI,t.SECOND_TO_MILLISECOND=1e3,t.NO_TWEEN=100,t.VERSION="4.7",t}();t.DragonBones=e,egret.registerClass(e,"dragonBones.DragonBones")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.toString=function(){return"[Class dragonBones.EventObject]"},n._onClear=function(){this.type=null,this.name=null,this.data=null,this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.userData=null},e.START="start",e.LOOP_COMPLETE="loopComplete",e.COMPLETE="complete",e.FADE_IN="fadeIn",e.FADE_IN_COMPLETE="fadeInComplete",e.FADE_OUT="fadeOut",e.FADE_OUT_COMPLETE="fadeOutComplete",e.FRAME_EVENT="frameEvent",e.SOUND_EVENT="soundEvent",e}(t.BaseObject);t.EventObject=e,egret.registerClass(e,"dragonBones.EventObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.textures={}}__extends(e,t);var i=(__define,e),n=i.prototype;return n._onClear=function(){this.autoSearch=!1,this.scale=1,this.name=null,this.imagePath=null;for(var t in this.textures)this.textures[t].returnToPool(),delete this.textures[t]},n.addTextureData=function(t){if(!t||!t.name||this.textures[t.name])throw new Error;this.textures[t.name]=t,t.parent=this},n.getTextureData=function(t){return this.textures[t]},e}(t.BaseObject);t.TextureAtlasData=e,egret.registerClass(e,"dragonBones.TextureAtlasData");var i=function(e){function i(){e.call(this),this.region=new t.Rectangle}__extends(i,e);var n=(__define,i),s=n.prototype;return i.generateRectangle=function(){return new t.Rectangle},s._onClear=function(){this.rotated=!1,this.name=null,this.frame=null,this.parent=null,this.region.clear()},i}(t.BaseObject);t.TextureData=i,egret.registerClass(i,"dragonBones.TextureData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function n(){e.call(this)}__extends(n,e);var s=(__define,n),a=s.prototype;return n.toString=function(){return"[Class dragonBones.EgretTextureAtlasData]"},a._onClear=function(){e.prototype._onClear.call(this),this.texture&&(this.texture=null)},a.generateTextureData=function(){return t.BaseObject.borrowObject(i)},n}(t.TextureAtlasData);t.EgretTextureAtlasData=e,egret.registerClass(e,"dragonBones.EgretTextureAtlasData");var i=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.toString=function(){return"[Class dragonBones.EgretTextureData]"},n._onClear=function(){t.prototype._onClear.call(this),this.texture&&(this.texture.dispose(),this.texture=null)},e}(t.TextureData);t.EgretTextureData=i,egret.registerClass(i,"dragonBones.EgretTextureData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(t,i,n,s){e.call(this,t,i,n,s)}__extends(i,e);var n=__define,s=i,a=s.prototype;return n(a,"eventObject",function(){return this.data}),n(a,"frameLabel",function(){return this.eventObject.name}),n(a,"sound",function(){return this.eventObject.name}),n(a,"animationName",function(){return this.eventObject.animationState.name}),n(a,"armature",function(){return this.eventObject.armature}),n(a,"bone",function(){return this.eventObject.bone}),n(a,"slot",function(){return this.eventObject.slot}),n(a,"animationState",function(){return this.eventObject.animationState}),i.START=t.EventObject.START,i.LOOP_COMPLETE=t.EventObject.LOOP_COMPLETE,i.COMPLETE=t.EventObject.COMPLETE,i.FADE_IN=t.EventObject.FADE_IN,i.FADE_IN_COMPLETE=t.EventObject.FADE_IN_COMPLETE,i.FADE_OUT=t.EventObject.FADE_OUT,i.FADE_OUT_COMPLETE=t.EventObject.FADE_OUT_COMPLETE,i.FRAME_EVENT=t.EventObject.FRAME_EVENT,i.SOUND_EVENT=t.EventObject.SOUND_EVENT,i.ANIMATION_FRAME_EVENT=t.EventObject.FRAME_EVENT,i.BONE_FRAME_EVENT=t.EventObject.FRAME_EVENT,i.MOVEMENT_FRAME_EVENT=t.EventObject.FRAME_EVENT,i}(egret.Event);t.EgretEvent=e,egret.registerClass(e,"dragonBones.EgretEvent");var i=function(t){function i(){t.call(this)}__extends(i,t);var n=__define,s=i,a=s.prototype;return a._advanceTimeHandler=function(t){return this._passedTime=t-this._time,this._armature.advanceTime(.001*this._passedTime),this._time=t,!1},a._onClear=function(){this.advanceTimeBySelf(!1),this._armature=null,this._passedTime=0,this._time=0
},a._dispatchEvent=function(t){var i=egret.Event.create(e,t.type);i.data=t,this.dispatchEvent(i),egret.Event.release(i)},a.hasEvent=function(t){return this.hasEventListener(t)},a.addEvent=function(t,e,i){this.addEventListener(t,e,i)},a.removeEvent=function(t,e,i){this.removeEventListener(t,e,i)},a.advanceTimeBySelf=function(t){t?(this._time=egret.getTimer(),egret.startTick(this._advanceTimeHandler,this)):egret.stopTick(this._advanceTimeHandler,this)},a.dispose=function(){this._armature&&this._armature.dispose()},n(a,"armature",function(){return this._armature}),n(a,"animation",function(){return this._armature.animation}),i}(egret.DisplayObjectContainer);t.EgretArmatureDisplay=i,egret.registerClass(i,"dragonBones.EgretArmatureDisplay",["dragonBones.IArmatureDisplay","dragonBones.IEventDispatcher"]);var n=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e);i.prototype;return e}(e);t.AnimationEvent=n,egret.registerClass(n,"dragonBones.AnimationEvent");var s=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e);i.prototype;return e}(e);t.FrameEvent=s,egret.registerClass(s,"dragonBones.FrameEvent");var a=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e);i.prototype;return e}(e);t.SoundEvent=a,egret.registerClass(a,"dragonBones.SoundEvent");var r=function(e){function i(i,n,s){void 0===s&&(s=1),e.call(this),this._onClear(),this.texture=i,t.ObjectDataParser.getInstance().parseTextureAtlasData(n,this,s)}__extends(i,e);var n=(__define,i),s=n.prototype;return i.toString=function(){return"[Class dragonBones.EgretTextureAtlas]"},s.dispose=function(){this.returnToPool()},i}(t.EgretTextureAtlasData);t.EgretTextureAtlas=r,egret.registerClass(r,"dragonBones.EgretTextureAtlas");var o=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e);i.prototype;return e}(r);t.EgretSheetAtlas=o,egret.registerClass(o,"dragonBones.EgretSheetAtlas");var l=function(){function e(){}var i=(__define,e);i.prototype;return e.getInstance=function(){return t.Armature._soundEventManager},e}();t.SoundEventManager=l,egret.registerClass(l,"dragonBones.SoundEventManager")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,n,s,a,r,o){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n=1),void 0===s&&(s=0),void 0===a&&(a=0),void 0===r&&(r=0),void 0===o&&(o=0),this.alphaMultiplier=t,this.redMultiplier=e,this.greenMultiplier=i,this.blueMultiplier=n,this.alphaOffset=s,this.redOffset=a,this.greenOffset=r,this.blueOffset=o}var e=(__define,t),i=e.prototype;return i.copyFrom=function(t){this.alphaMultiplier=t.alphaMultiplier,this.redMultiplier=t.redMultiplier,this.greenMultiplier=t.greenMultiplier,this.blueMultiplier=t.blueMultiplier,this.alphaOffset=t.alphaOffset,this.redOffset=t.redOffset,this.redOffset=t.redOffset,this.greenOffset=t.blueOffset},i.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0},t}();t.ColorTransform=e,egret.registerClass(e,"dragonBones.ColorTransform")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.autoSearch=!1,this._objectDataParser=new t.ObjectDataParser,this._dragonBonesDataMap={},this._textureAtlasDataMap={}}var i=(__define,e),n=i.prototype;return n._getTextureData=function(t,e){var i=this._textureAtlasDataMap[t];if(i)for(var n=0,s=i.length;s>n;++n){var a=i[n].getTextureData(e);if(a)return a}if(this.autoSearch)for(var n in this._textureAtlasDataMap){i=this._textureAtlasDataMap[n];for(var r=0,o=i.length;o>r;++r){var l=i[r];if(l.autoSearch){var a=l.getTextureData(e);if(a)return a}}}return null},n._fillBuildArmaturePackage=function(t,e,i,n){if(t){var s=this._dragonBonesDataMap[t];if(s){var a=s.getArmature(e);if(a)return n.dataName=t,n.data=s,n.armature=a,n.skin=a.getSkin(i),n.skin||(n.skin=a.defaultSkin),!0}}if(!t||this.autoSearch)for(var r in this._dragonBonesDataMap){var s=this._dragonBonesDataMap[r];if(!t||s.autoSearch){var a=s.getArmature(e);if(a)return n.dataName=r,n.data=s,n.armature=a,n.skin=a.getSkin(i),n.skin||(n.skin=a.defaultSkin),!0}}return!1},n._buildBones=function(e,i){for(var n=e.armature.sortedBones,s=0,a=n.length;a>s;++s){var r=n[s],o=t.BaseObject.borrowObject(t.Bone);o.name=r.name,o.inheritTranslation=r.inheritTranslation,o.inheritRotation=r.inheritRotation,o.inheritScale=r.inheritScale,o.length=r.length,o.origin.copyFrom(r.transform),r.parent?i.addBone(o,r.parent.name):i.addBone(o),r.ik&&(o.ikBendPositive=r.bendPositive,o.ikWeight=r.weight,o._setIK(i.getBone(r.ik.name),r.chain,r.chainIndex))}},n._buildSlots=function(t,e){var i=t.skin,n=t.armature.defaultSkin,s={};for(var a in n.slots){var r=n.slots[a];s[r.slot.name]=r}if(i!=n)for(var a in i.slots){var r=i.slots[a];s[r.slot.name]=r}for(var o=t.armature.sortedSlots,a=0,l=o.length;l>a;++a){var h=o[a],r=s[h.name];if(r){var _=this._generateSlot(t,r);_._displayDataSet=r,_._setDisplayIndex(h.displayIndex),_._setBlendMode(h.blendMode),_._setColor(h.color),_._replacedDisplayDataSet.length=_._displayDataSet.displays.length,e.addSlot(_,h.parent.name)}}},n._replaceSlotDisplay=function(t,e,i,n){if(0>n&&(n=i.displayIndex),n>=0){var s=i.displayList;if(s.length<=n&&(s.length=n+1),e.textureData||(e.textureData=this._getTextureData(t.dataName,e.name)),1==e.type){var a=this.buildArmature(e.name,t.dataName);s[n]=a}else i._replacedDisplayDataSet.length<=n&&(i._replacedDisplayDataSet.length=n+1),i._replacedDisplayDataSet[n]=e,e.meshData?s[n]=i.MeshDisplay:s[n]=i.rawDisplay;i.displayList=s,i.invalidUpdate()}},n.parseDragonBonesData=function(t,e){void 0===e&&(e=null);var i=this._objectDataParser.parseDragonBonesData(t);return this.addDragonBonesData(i,e),i},n.parseTextureAtlasData=function(t,e,i,n){void 0===i&&(i=null),void 0===n&&(n=0);var s=this._generateTextureAtlasData(null,null);return this._objectDataParser.parseTextureAtlasData(t,s,n),this._generateTextureAtlasData(s,e),this.addTextureAtlasData(s,i),s},n.getDragonBonesData=function(t){return this._dragonBonesDataMap[t]},n.addDragonBonesData=function(t,e){if(void 0===e&&(e=null),!t)throw new Error;e=e||t.name,e?this._dragonBonesDataMap[e]?console.warn("Same name data."):this._dragonBonesDataMap[e]=t:console.warn("Unnamed data.")},n.removeDragonBonesData=function(t,e){void 0===e&&(e=!0);var i=this._dragonBonesDataMap[t];i&&(e&&i.returnToPool(),delete this._dragonBonesDataMap[t])},n.getTextureAtlasData=function(t){return this._textureAtlasDataMap[t]},n.addTextureAtlasData=function(t,e){if(void 0===e&&(e=null),!t)throw new Error;if(e=e||t.name){var i=this._textureAtlasDataMap[e]=this._textureAtlasDataMap[e]||[];i.indexOf(t)<0&&i.push(t)}else console.warn("Unnamed data.")},n.removeTextureAtlasData=function(t,e){void 0===e&&(e=!0);var i=this._textureAtlasDataMap[t];if(i){if(e)for(var n=0,s=i.length;s>n;++n)i[n].returnToPool();delete this._textureAtlasDataMap[t]}},n.clear=function(t){void 0===t&&(t=!0);for(var e in this._dragonBonesDataMap)t&&this._dragonBonesDataMap[e].returnToPool(),delete this._dragonBonesDataMap[e];for(var e in this._textureAtlasDataMap){if(t)for(var i=this._textureAtlasDataMap[e],n=0,s=i.length;s>n;++n)i[n].returnToPool();delete this._textureAtlasDataMap[e]}},n.buildArmature=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n={};if(this._fillBuildArmaturePackage(e,t,i,n)){var s=this._generateArmature(n);return this._buildBones(n,s),this._buildSlots(n,s),s.advanceTime(0),s}return null},n.copyAnimationsToArmature=function(e,i,n,s,a){void 0===n&&(n=null),void 0===s&&(s=null),void 0===a&&(a=!0);var r={};if(this._fillBuildArmaturePackage(s,i,n,r)){var o=r.armature;if(a)e.animation.animations=o.animations;else{var l={};for(var h in e.animation.animations)l[h]=e.animation.animations[h];for(var h in o.animations)l[h]=o.animations[h];e.animation.animations=l}if(r.skin){for(var _=e.getSlots(),u=0,f=_.length;f>u;++u)for(var m=_[u],d=m.displayList,c=0,g=d.length;g>c;++c){var p=d[c];if(p instanceof t.Armature){var v=r.skin.getSlot(m.name).displays;if(c<v.length){var T=v[c];1==T.type&&this.copyAnimationsToArmature(p,T.name,n,s,a)}}}return!0}}return!1},n.replaceSlotDisplay=function(t,e,i,n,s,a){void 0===a&&(a=-1);var r={};if(this._fillBuildArmaturePackage(t,e,null,r)){var o=r.skin.getSlot(i);if(o)for(var l=0,h=o.displays.length;h>l;++l){var _=o.displays[l];if(_.name==n){this._replaceSlotDisplay(r,_,s,a);break}}}},n.replaceSlotDisplayList=function(t,e,i,n){var s={};if(this._fillBuildArmaturePackage(t,e,null,s)){var a=s.skin.getSlot(i);if(a)for(var r=0,o=0,l=a.displays.length;l>o;++o){var h=a.displays[o];this._replaceSlotDisplay(s,h,n,r++)}}},e}();t.BaseFactory=e,egret.registerClass(e,"dragonBones.BaseFactory")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),t.Armature._soundEventManager||(t.Armature._soundEventManager=new t.EgretArmatureDisplay)}__extends(i,e);var n=__define,s=i,a=s.prototype;return a._generateTextureAtlasData=function(e,i){return e?e.texture=i:e=t.BaseObject.borrowObject(t.EgretTextureAtlasData),e},a._generateArmature=function(e){var i=t.BaseObject.borrowObject(t.Armature),n=new t.EgretArmatureDisplay;return i._armatureData=e.armature,i._skinData=e.skin,i._animation=t.BaseObject.borrowObject(t.Animation),i._display=n,n._armature=i,i._animation._armature=i,i.animation.animations=e.armature.animations,i},a._generateSlot=function(e,i){var n=t.BaseObject.borrowObject(t.EgretSlot),s=i.slot,a=[];n.name=s.name,n._rawDisplay=new egret.Bitmap,n._meshDisplay=new egret.Mesh;for(var r=0,o=i.displays.length;o>r;++r){var l=i.displays[r];switch(l.type){case 0:l.textureData||(l.textureData=this._getTextureData(e.dataName,l.name)),a.push(n._rawDisplay);break;case 2:l.textureData||(l.textureData=this._getTextureData(e.dataName,l.name)),a.push("webgl"==egret.Capabilities.renderMode?n._meshDisplay:n._rawDisplay);break;case 1:var h=this.buildArmature(l.name,e.dataName);h&&h.animation.play(),a.push(h);break;default:a.push(null)}}return n._setDisplayList(a),n},a.buildArmatureDisplay=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=this.buildArmature(t,e,i),s=n?n._display:null;return s&&s.advanceTimeBySelf(!0),s},n(a,"soundEventManater",function(){return t.Armature._soundEventManager}),a.addSkeletonData=function(t,e){void 0===e&&(e=null),this.addDragonBonesData(t,e)},a.getSkeletonData=function(t){return this.getDragonBonesData(t)},a.removeSkeletonData=function(t){this.removeSkeletonData(t)},a.addTextureAtlas=function(t,e){void 0===e&&(e=null),this.addTextureAtlasData(t,e)},a.getTextureAtlas=function(t){return this.getTextureAtlasData(t)},a.removeTextureAtlas=function(t){this.removeTextureAtlasData(t)},a.buildFastArmature=function(t,e,i){return void 0===e&&(e=null),void 0===i&&(i=null),this.buildArmature(t,e,i)},i}(t.BaseFactory);t.EgretFactory=e,egret.registerClass(e,"dragonBones.EgretFactory")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.toString=function(){return"[Class dragonBones.EgretSlot]"},n._onClear=function(){t.prototype._onClear.call(this),this.transformUpdateEnabled=!1,this._renderDisplay=null,this._colorFilter=null},n._onUpdateDisplay=function(){this._rawDisplay||(this._rawDisplay=new egret.Bitmap),this._renderDisplay=this._display||this._rawDisplay},n._initDisplay=function(t){},n._addDisplay=function(){var t=this._armature._display;t.addChild(this._renderDisplay)},n._replaceDisplay=function(t){var e=this._armature._display,i=t;e.addChild(this._renderDisplay),e.swapChildren(this._renderDisplay,i),e.removeChild(i)},n._removeDisplay=function(){this._renderDisplay.parent.removeChild(this._renderDisplay)},n._disposeDisplay=function(t){},n._updateVisible=function(){this._renderDisplay.visible=this._parent.visible},n._updateBlendMode=function(){if(this._blendMode<e.BLEND_MODE_LIST.length){var t=e.BLEND_MODE_LIST[this._blendMode];t&&(this._renderDisplay.blendMode=t)}},n._updateColor=function(){if(1!=this._colorTransform.redMultiplier||1!=this._colorTransform.greenMultiplier||1!=this._colorTransform.blueMultiplier||0!=this._colorTransform.redOffset||0!=this._colorTransform.greenOffset||0!=this._colorTransform.blueOffset){this._colorFilter||(this._colorFilter=new egret.ColorMatrixFilter);var t=this._colorFilter.matrix;t[0]=this._colorTransform.redMultiplier,t[6]=this._colorTransform.greenMultiplier,t[12]=this._colorTransform.blueMultiplier,t[18]=this._colorTransform.alphaMultiplier,t[4]=this._colorTransform.redOffset,t[9]=this._colorTransform.greenOffset,t[14]=this._colorTransform.blueOffset,this._colorFilter.matrix=t;var e=this._renderDisplay.filters;e||(e=[]),e.indexOf(this._colorFilter)<0&&e.push(this._colorFilter),this._renderDisplay.filters=e}else this._colorFilter&&(this._colorFilter=null,this._renderDisplay.filters=null),this._renderDisplay.$setAlpha(this._colorTransform.alphaMultiplier)},n._updateFilters=function(){},n._updateFrame=function(){var t=this._renderDisplay;if(this._display&&this._displayIndex>=0){var e=this._displayIndex<this._displayDataSet.displays.length?this._displayDataSet.displays[this._displayIndex]:null,i=this._displayIndex<this._replacedDisplayDataSet.length?this._replacedDisplayDataSet[this._displayIndex]:null,n=i||e,s=n.textureData;if(s){if(!s.texture){var a=s.parent.texture;a&&(s.texture=new egret.Texture,s.texture._bitmapData=a._bitmapData,s.texture.$initData(s.region.x,s.region.y,s.region.width,s.region.height,0,0,s.region.width,s.region.height,a.textureWidth,a.textureHeight))}var r=this._armature._replacedTexture||s.texture;if(r){if(this._meshData&&this._display==this._meshDisplay){for(var o=this._meshDisplay,l=o.$renderNode,h=0,_=this._meshData.vertices.length;_>h;++h)l.uvs[h]=this._meshData.uvs[h],l.vertices[h]=this._meshData.vertices[h];for(var h=0,_=this._meshData.vertexIndices.length;_>h;++h)l.indices[h]=this._meshData.vertexIndices[h];o.$setBitmapData(r),o.$updateVertices(),o.$invalidateTransform()}else{var u=s.frame||s.region,f=u.width,m=u.height;s.rotated&&(f=u.height,m=u.width);var d=n.pivot.x,c=n.pivot.y;n.isRelativePivot&&(d=f*d,c=m*c),s.frame&&(d+=s.frame.x,c+=s.frame.y),e&&i&&(d+=e.transform.x-i.transform.x,c+=e.transform.y-i.transform.y),t.$setBitmapData(r),t.$setAnchorOffsetX(d),t.$setAnchorOffsetY(c)}return void this._updateVisible()}}}t.$setBitmapData(null),t.$setAnchorOffsetX(0),t.$setAnchorOffsetY(0),t.visible=!1},n._updateMesh=function(){var t=this._meshDisplay,e=t.$renderNode,i=this._ffdVertices.length>0;if(this._meshData.skinned){for(var n=0,s=0,a=this._meshData.vertices.length;a>n;n+=2){for(var r=n/2,o=this._meshData.boneIndices[r],l=this._meshData.boneVertices[r],h=this._meshData.weights[r],_=0,u=0,f=0,m=o.length;m>f;++f){var d=this._meshBones[o[f]],c=d.globalTransformMatrix,g=h[f],p=0,v=0;i?(p=l[2*f]+this._ffdVertices[s],v=l[2*f+1]+this._ffdVertices[s+1]):(p=l[2*f],v=l[2*f+1]),_+=(c.a*p+c.c*v+c.tx)*g,u+=(c.b*p+c.d*v+c.ty)*g,s+=2}e.vertices[n]=_,e.vertices[n+1]=u}t.$updateVertices(),t.$invalidateTransform()}else if(i){for(var T=this._meshData.vertices,n=0,a=this._meshData.vertices.length;a>n;n+=2){var _=T[n]+this._ffdVertices[n],u=T[n+1]+this._ffdVertices[n+1];e.vertices[n]=_,e.vertices[n+1]=u}t.$updateVertices(),t.$invalidateTransform()}},n._updateTransform=function(){this._renderDisplay.$setMatrix(this.globalTransformMatrix,this.transformUpdateEnabled)},e.BLEND_MODE_LIST=[egret.BlendMode.NORMAL,egret.BlendMode.ADD,null,null,null,egret.BlendMode.ERASE,null,null,null,null,null,null,null,null],e}(t.Slot);t.EgretSlot=e,egret.registerClass(e,"dragonBones.EgretSlot")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,n,s,a){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=0),void 0===a&&(a=0),this.a=t,this.b=e,this.c=i,this.d=n,this.tx=s,this.ty=a}var e=(__define,t),i=e.prototype;return i.copyFrom=function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty},i.identity=function(){this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0},i.concat=function(t){var e=this.a,i=this.b,n=this.c,s=this.d,a=this.tx,r=this.ty,o=t.a,l=t.b,h=t.c,_=t.d,u=t.tx,f=t.ty;this.a=e*o+i*h,this.b=e*l+i*_,this.c=n*o+s*h,this.d=n*l+s*_,this.tx=o*a+h*r+u,this.ty=_*r+l*a+f},i.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,s=this.tx,a=this.ty,r=t*n-e*i;this.a=n/r,this.b=-e/r,this.c=-i/r,this.d=t/r,this.tx=(i*a-n*s)/r,this.ty=-(t*a-e*s)/r},i.transformPoint=function(t,e,i,n){void 0===n&&(n=!1),i.x=this.a*t+this.c*e,i.y=this.b*t+this.d*e,n||(i.x+=this.tx,i.y+=this.ty)},t}();t.Matrix=e,egret.registerClass(e,"dragonBones.Matrix")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var e=(__define,t),i=e.prototype;return i.copyFrom=function(t){this.x=t.x,this.y=t.y},i.clear=function(){this.x=this.y=0},t}();t.Point=e,egret.registerClass(e,"dragonBones.Point")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.width=i,this.height=n}var e=(__define,t),i=e.prototype;return i.copyFrom=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},i.clear=function(){this.x=this.y=0,this.width=this.height=0},t}();t.Rectangle=e,egret.registerClass(e,"dragonBones.Rectangle")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,n,s,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=1),void 0===a&&(a=1),this.x=t,this.y=e,this.skewX=i,this.skewY=n,this.scaleX=s,this.scaleY=a}var e=__define,i=t,n=i.prototype;return t.normalizeRadian=function(t){return t=(t+Math.PI)%(2*Math.PI),t+=t>0?-Math.PI:Math.PI},n.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skewX/Math.PI+" skewY:"+180*this.skewY/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},n.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.skewX=t.skewX,this.skewY=t.skewY,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this},n.clone=function(){var e=new t;return e.copyFrom(this),e},n.identity=function(){return this.x=this.y=this.skewX=this.skewY=0,this.scaleX=this.scaleY=1,this},n.add=function(t){return this.x+=t.x,this.y+=t.y,this.skewX+=t.skewX,this.skewY+=t.skewY,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this},n.minus=function(e){return this.x-=e.x,this.y-=e.y,this.skewX=t.normalizeRadian(this.skewX-e.skewX),this.skewY=t.normalizeRadian(this.skewY-e.skewY),this.scaleX/=e.scaleX,this.scaleY/=e.scaleY,this},n.fromMatrix=function(t){var e=.25*Math.PI,i=this.scaleX,n=this.scaleY;return this.x=t.tx,this.y=t.ty,this.skewX=Math.atan(-t.c/t.d),this.skewY=Math.atan(t.b/t.a),this.skewX!=this.skewX&&(this.skewX=0),this.skewY!=this.skewY&&(this.skewY=0),this.scaleY=this.skewX>-e&&this.skewX<e?t.d/Math.cos(this.skewX):-t.c/Math.sin(this.skewX),this.scaleX=this.skewY>-e&&this.skewY<e?t.a/Math.cos(this.skewY):t.b/Math.sin(this.skewY),i>=0&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.skewY=this.skewY-Math.PI),n>=0&&this.scaleY<0&&(this.scaleY=-this.scaleY,this.skewX=this.skewX-Math.PI),this},n.toMatrix=function(t){t.a=this.scaleX*Math.cos(this.skewY),t.b=this.scaleX*Math.sin(this.skewY),t.c=-this.scaleY*Math.sin(this.skewX),t.d=this.scaleY*Math.cos(this.skewX),t.tx=this.x,t.ty=this.y},e(n,"rotation",function(){return this.skewY},function(t){var e=t-this.skewY;this.skewX+=e,this.skewY+=e}),t}();t.Transform=e,egret.registerClass(e,"dragonBones.Transform")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.frames=[]}__extends(e,t);var i=(__define,e),n=i.prototype;return n._onClear=function(){if(this.scale=1,this.offset=0,this.frames.length){for(var t=null,e=0,i=this.frames.length;i>e;++e){var n=this.frames[e];t&&n!=t&&t.returnToPool(),t=n}this.frames.length=0}},e}(t.BaseObject);t.TimelineData=e,egret.registerClass(e,"dragonBones.TimelineData");var i=function(e){function i(){e.call(this),this.bone=null,this.originTransform=new t.Transform,this.cachedFrames=[]}__extends(i,e);var n=(__define,i),s=n.prototype;return i.cacheFrame=function(e,i,n){var s=e[i]=new t.Matrix;return s.copyFrom(n),s},i.toString=function(){return"[Class dragonBones.BoneTimelineData]"},s._onClear=function(){e.prototype._onClear.call(this),this.bone=null,this.originTransform.identity(),this.cachedFrames.length&&(this.cachedFrames.length=0)},s.cacheFrames=function(t){this.cachedFrames.length=0,this.cachedFrames.length=t},i}(e);t.BoneTimelineData=i,egret.registerClass(i,"dragonBones.BoneTimelineData");var n=function(e){function i(){e.call(this),this.slot=null,this.cachedFrames=[]}__extends(i,e);var n=(__define,i),s=n.prototype;return i.cacheFrame=function(e,i,n){var s=e[i]=new t.Matrix;return s.copyFrom(n),s},i.toString=function(){return"[Class dragonBones.SlotTimelineData]"},s._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this.cachedFrames&&(this.cachedFrames.length=0)},s.cacheFrames=function(t){this.cachedFrames.length=0,this.cachedFrames.length=t},i}(e);t.SlotTimelineData=n,egret.registerClass(n,"dragonBones.SlotTimelineData");var s=function(t){function e(){t.call(this),this.displayIndex=0,this.skin=null,this.slot=null}__extends(e,t);var i=(__define,e),n=i.prototype;return e.toString=function(){return"[Class dragonBones.FFDTimelineData]"},n._onClear=function(){t.prototype._onClear.call(this),this.displayIndex=0,this.skin=null,this.slot=null},e}(e);t.FFDTimelineData=s,egret.registerClass(s,"dragonBones.FFDTimelineData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.boneTimelines={},this.slotTimelines={},this.ffdTimelines={},this.cachedFrames=[]}__extends(e,t);var i=(__define,e),n=i.prototype;return e.toString=function(){return"[Class dragonBones.AnimationData]"},n._onClear=function(){t.prototype._onClear.call(this),this.hasAsynchronyTimeline=!1,this.cacheTimeToFrameScale=0,this.position=0,this.duration=0,this.playTimes=0,this.fadeInTime=0,this.name=null,this.animation=null;for(var e in this.boneTimelines)this.boneTimelines[e].returnToPool(),delete this.boneTimelines[e];for(var e in this.slotTimelines)this.slotTimelines[e].returnToPool(),delete this.slotTimelines[e];for(var e in this.ffdTimelines){for(var i in this.ffdTimelines[e])for(var n in this.ffdTimelines[e][i])this.ffdTimelines[e][i][n].returnToPool();delete this.ffdTimelines[e]}this.cachedFrames.length&&(this.cachedFrames.length=0)},n.cacheFrames=function(t){if(!this.animation){var e=Math.max(Math.floor(this.frameCount*this.scale*t),1);this.cacheTimeToFrameScale=e/(this.duration+1e-6),this.cachedFrames.length=0,this.cachedFrames.length=e;for(var i in this.boneTimelines)this.boneTimelines[i].cacheFrames(e);for(var i in this.slotTimelines)this.slotTimelines[i].cacheFrames(e)}},n.addBoneTimeline=function(t){if(!t||!t.bone||this.boneTimelines[t.bone.name])throw new Error;this.boneTimelines[t.bone.name]=t},n.addSlotTimeline=function(t){if(!t||!t.slot||this.slotTimelines[t.slot.name])throw new Error;this.slotTimelines[t.slot.name]=t},n.addFFDTimeline=function(t){if(!(t&&t.skin&&t.slot))throw new Error;var e=this.ffdTimelines[t.skin.name]=this.ffdTimelines[t.skin.name]||{},i=e[t.slot.slot.name]=e[t.slot.slot.name]||{};if(i[t.displayIndex])throw new Error;i[t.displayIndex]=t},n.getBoneTimeline=function(t){return this.boneTimelines[t]},n.getSlotTimeline=function(t){return this.slotTimelines[t]},n.getFFDTimeline=function(t,e,i){var n=this.ffdTimelines[t];if(n){var s=n[e];if(s)return s[i]}return null},e}(t.TimelineData);t.AnimationData=e,egret.registerClass(e,"dragonBones.AnimationData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.bones={},this.slots={},this.skins={},this.animations={},this._sortedBones=[],this._sortedSlots=[],this._bonesChildren={}}__extends(e,t);var i=__define,n=e,s=n.prototype;return e._onSortSlots=function(t,e){return t.zOrder>e.zOrder?1:-1},e.toString=function(){return"[Class dragonBones.ArmatureData]"},s._onClear=function(){this.frameRate=0,this.cacheFrameRate=0,this.type=0,this.name=null;for(var t in this.bones)this.bones[t].returnToPool(),delete this.bones[t];for(var t in this.slots)this.slots[t].returnToPool(),delete this.slots[t];for(var t in this.skins)this.skins[t].returnToPool(),delete this.skins[t];for(var t in this.animations)this.animations[t].returnToPool(),delete this.animations[t];this._boneDirty=!1,this._slotDirty=!1,this._defaultSkin=null,this._defaultAnimation=null,this._sortedBones.length&&(this._sortedBones.length=0),this._sortedSlots.length&&(this._sortedSlots.length=0);for(var t in this._bonesChildren)delete this._bonesChildren[t]},s._sortBones=function(){var t=this._sortedBones.length;if(t){var e=this._sortedBones.concat(),i=0,n=0;for(this._sortedBones.length=0;t>n;){var s=e[i++];i>=t&&(i=0),this._sortedBones.indexOf(s)>=0||s.parent&&this._sortedBones.indexOf(s.parent)<0||s.ik&&this._sortedBones.indexOf(s.ik)<0||(s.ik&&s.chain>0&&s.chainIndex==s.chain?this._sortedBones.splice(this._sortedBones.indexOf(s.parent)+1,0,s):this._sortedBones.push(s),n++)}}},s._sortSlots=function(){this._sortedSlots.sort(e._onSortSlots)},s.cacheFrames=function(t){if(this.cacheFrameRate!=t){this.cacheFrameRate=t;var e=this.cacheFrameRate/this.frameRate;for(var i in this.animations)this.animations[i].cacheFrames(e)}},s.addBone=function(t,e){if(!t||!t.name||this.bones[t.name])throw new Error;if(e){var i=this.getBone(e);i?t.parent=i:(this._bonesChildren[e]=this._bonesChildren[e]||[]).push(t)}var n=this._bonesChildren[t.name];if(n){for(var s=0,a=n.length;a>s;++s)n[s].parent=t;delete this._bonesChildren[t.name]}this.bones[t.name]=t,this._sortedBones.push(t),this._boneDirty=!0},s.addSlot=function(t){if(!t||!t.name||this.slots[t.name])throw new Error;this.slots[t.name]=t,this._sortedSlots.push(t),this._slotDirty=!0},s.addSkin=function(t){if(!t||!t.name||this.skins[t.name])throw new Error;this.skins[t.name]=t,this._defaultSkin||(this._defaultSkin=t)},s.addAnimation=function(t){if(!t||!t.name||this.animations[t.name])throw new Error;this.animations[t.name]=t,this._defaultAnimation||(this._defaultAnimation=t)},s.getBone=function(t){return this.bones[t]},s.getSlot=function(t){return this.slots[t]},s.getSkin=function(t){return t?this.skins[t]:this._defaultSkin},s.getAnimation=function(t){return t?this.animations[t]:this._defaultAnimation},i(s,"sortedBones",function(){return this._boneDirty&&(this._boneDirty=!1,this._sortBones()),this._sortedBones}),i(s,"sortedSlots",function(){return this._slotDirty&&(this._slotDirty=!1,this._sortSlots()),this._sortedSlots}),i(s,"defaultSkin",function(){return this._defaultSkin}),i(s,"defaultAnimation",function(){return this._defaultAnimation}),e}(t.BaseObject);t.ArmatureData=e,egret.registerClass(e,"dragonBones.ArmatureData");var i=function(e){function i(){e.call(this),this.transform=new t.Transform}__extends(i,e);var n=(__define,i),s=n.prototype;return i.toString=function(){return"[Class dragonBones.BoneData]"},s._onClear=function(){this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.bendPositive=!1,this.chain=0,this.chainIndex=0,this.weight=0,this.length=0,this.name=null,this.parent=null,this.ik=null,this.transform.identity()},i}(t.BaseObject);t.BoneData=i,egret.registerClass(i,"dragonBones.BoneData");var n=function(e){function i(){e.call(this)}__extends(i,e);var n=(__define,i),s=n.prototype;return i.generateColor=function(){return new t.ColorTransform},i.toString=function(){return"[Class dragonBones.SlotData]"},s._onClear=function(){this.displayIndex=0,this.zOrder=0,this.blendMode=0,this.name=null,this.parent=null,this.color=null},i.DEFAULT_COLOR=new t.ColorTransform,i}(t.BaseObject);t.SlotData=n,egret.registerClass(n,"dragonBones.SlotData");var s=function(t){function e(){t.call(this),this.name=null,this.slots={}}__extends(e,t);var i=(__define,e),n=i.prototype;return e.toString=function(){return"[Class dragonBones.SkinData]"},n._onClear=function(){this.name=null;for(var t in this.slots)this.slots[t].returnToPool(),delete this.slots[t]},n.addSlot=function(t){t&&t.slot&&!this.slots[t.slot.name]&&(this.slots[t.slot.name]=t)},n.getSlot=function(t){return this.slots[t]},e}(t.BaseObject);t.SkinData=s,egret.registerClass(s,"dragonBones.SkinData");var a=function(t){function e(){t.call(this),this.displays=[]}__extends(e,t);var i=(__define,e),n=i.prototype;return e.toString=function(){return"[Class dragonBones.SlotDisplayDataSet]"},n._onClear=function(){if(this.slot=null,this.displays.length){for(var t=0,e=this.displays.length;e>t;++t)this.displays[t].returnToPool();this.displays.length=0}},e}(t.BaseObject);t.SlotDisplayDataSet=a,egret.registerClass(a,"dragonBones.SlotDisplayDataSet");var r=function(e){function i(){e.call(this),this.pivot=new t.Point,this.transform=new t.Transform}__extends(i,e);var n=(__define,i),s=n.prototype;return i.toString=function(){return"[Class dragonBones.DisplayData]"},s._onClear=function(){this.isRelativePivot=!1,this.type=0,this.name=null,this.textureData=null,this.armatureData=null,this.meshData&&(this.meshData.returnToPool(),this.meshData=null),this.pivot.clear(),this.transform.identity()},i}(t.BaseObject);t.DisplayData=r,egret.registerClass(r,"dragonBones.DisplayData");var o=function(e){function i(){e.call(this),this.slotPose=new t.Matrix,this.uvs=[],this.vertices=[],this.vertexIndices=[],this.boneIndices=[],this.weights=[],this.boneVertices=[],this.bones=[],this.inverseBindPose=[]}__extends(i,e);var n=(__define,i),s=n.prototype;return i.toString=function(){return"[Class dragonBones.MeshData]"},s._onClear=function(){this.skinned=!1,this.slotPose.identity(),this.uvs.length&&(this.uvs.length=0),this.vertices.length&&(this.vertices.length=0),this.vertexIndices.length&&(this.vertexIndices.length=0),this.boneIndices.length&&(this.boneIndices.length=0),this.weights.length&&(this.weights.length=0),this.boneVertices.length&&(this.boneVertices.length=0),this.bones.length&&(this.bones.length=0),this.inverseBindPose.length&&(this.inverseBindPose.length=0)},i}(t.BaseObject);t.MeshData=o,egret.registerClass(o,"dragonBones.MeshData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.armatures={},this._armatureNames=[]}__extends(e,t);var i=__define,n=e,s=n.prototype;return e.toString=function(){return"[Class dragonBones.DragonBonesData]"},s._onClear=function(){this.autoSearch=!1,this.frameRate=0,this.name=null;for(var t in this.armatures)this.armatures[t].returnToPool(),delete this.armatures[t];this._armatureNames.length&&(this._armatureNames.length=0)},s.getArmature=function(t){return this.armatures[t]},s.addArmature=function(t){if(!t||!t.name||this.armatures[t.name])throw new Error;this.armatures[t.name]=t,this._armatureNames.push(t.name)},i(s,"armatureNames",function(){return this._armatureNames}),e}(t.BaseObject);t.DragonBonesData=e,egret.registerClass(e,"dragonBones.DragonBonesData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.toString=function(){return"[Class dragonBones.ActionData]"},n._onClear=function(){this.type=0,this.data=null,this.bone=null,this.slot=null},e}(t.BaseObject);t.ActionData=e,egret.registerClass(e,"dragonBones.ActionData");var i=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.toString=function(){return"[Class dragonBones.EventData]"},n._onClear=function(){this.type=0,this.name=null,this.data=null,this.bone=null,this.slot=null},e}(t.BaseObject);t.EventData=i,egret.registerClass(i,"dragonBones.EventData");
var n=function(t){function e(){t.call(this),this.actions=[],this.events=[]}__extends(e,t);var i=(__define,e),n=i.prototype;return n._onClear=function(){if(this.position=0,this.duration=0,this.prev=null,this.next=null,this.actions.length){for(var t=0,e=this.actions.length;e>t;++t)this.actions[t].returnToPool();this.actions.length=0}if(this.events.length){for(var t=0,e=this.events.length;e>t;++t)this.events[t].returnToPool();this.events.length=0}},e}(t.BaseObject);t.FrameData=n,egret.registerClass(n,"dragonBones.FrameData");var s=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.samplingCurve=function(t,e){if(0==t.length||0==e)return null;var i=e+2,n=1/i,s=new Array(2*(i-1));t.unshift(0,0),t.push(1,1);for(var a=0,r=0;i-1>r;++r){for(var o=n*(r+1);t[a+6]<o;)a+=6;var l=t[a],h=t[a+6],_=(o-l)/(h-l),u=1-_,f=u*u,m=_*_,d=u*f,c=3*_*f,g=3*u*m,p=_*m;s[2*r]=d*l+c*t[a+2]+g*t[a+4]+p*h,s[2*r+1]=d*t[a+1]+c*t[a+3]+g*t[a+5]+p*t[a+7]}return s},n._onClear=function(){t.prototype._onClear.call(this),this.tweenEasing=0,this.curve=null},e}(n);t.TweenFrameData=s,egret.registerClass(s,"dragonBones.TweenFrameData");var a=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.toString=function(){return"[Class dragonBones.AnimationFrameData]"},n._onClear=function(){t.prototype._onClear.call(this)},e}(n);t.AnimationFrameData=a,egret.registerClass(a,"dragonBones.AnimationFrameData");var r=function(e){function i(){e.call(this),this.transform=new t.Transform}__extends(i,e);var n=(__define,i),s=n.prototype;return i.toString=function(){return"[Class dragonBones.BoneFrameData]"},s._onClear=function(){e.prototype._onClear.call(this),this.tweenScale=!1,this.tweenRotate=0,this.parent=null,this.transform.identity()},i}(s);t.BoneFrameData=r,egret.registerClass(r,"dragonBones.BoneFrameData");var o=function(e){function i(){e.call(this)}__extends(i,e);var n=(__define,i),s=n.prototype;return i.generateColor=function(){return new t.ColorTransform},i.toString=function(){return"[Class dragonBones.SlotFrameData]"},s._onClear=function(){e.prototype._onClear.call(this),this.displayIndex=0,this.zOrder=0,this.color=null},i.DEFAULT_COLOR=new t.ColorTransform,i}(s);t.SlotFrameData=o,egret.registerClass(o,"dragonBones.SlotFrameData");var l=function(t){function e(){t.call(this),this.tweens=[],this.keys=[]}__extends(e,t);var i=(__define,e),n=i.prototype;return e.toString=function(){return"[Class dragonBones.ExtensionFrameData]"},n._onClear=function(){t.prototype._onClear.call(this),this.type=0,this.tweens.length&&(this.tweens.length=0),this.keys.length&&(this.keys.length=0)},e}(s);t.ExtensionFrameData=l,egret.registerClass(l,"dragonBones.ExtensionFrameData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._data=null,this._armature=null,this._skin=null,this._slotDisplayDataSet=null,this._mesh=null,this._animation=null,this._timeline=null,this._isParentCooriinate=!1,this._isAutoTween=!1,this._animationTweenEasing=0,this._armatureScale=1,this._helpPoint=new t.Point,this._helpTransform=new t.Transform,this._helpMatrix=new t.Matrix,this._rawBones=[]}var i=(__define,e),n=i.prototype;return e._getArmatureType=function(t){switch(t.toLowerCase()){case"stage":return 0;case"armature":return 0;case"movieClip":return 1;default:return 0}},e._getDisplayType=function(t){switch(t.toLowerCase()){case"image":return 0;case"armature":return 1;case"mesh":return 2;default:return 0}},e._getBlendMode=function(t){switch(t.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}},e._getActionType=function(t){switch(t.toLowerCase()){case"play":return 0;case"stop":return 1;case"gotoandplay":return 2;case"gotoandstop":return 3;case"fadein":return 4;case"fadeout":return 5;default:return 4}},n._getTimelineFrameMatrix=function(e,i,n,s){var a=Math.floor(n*e.frameCount/e.duration);if(1==i.frames.length||a>=i.frames.length)s.copyFrom(i.frames[0].transform);else{var r=i.frames[a],o=0;r.duration>0&&r.tweenEasing!=t.DragonBones.NO_TWEEN?(o=(n-r.position)/r.duration,0!=r.tweenEasing&&(o=t.TweenTimelineState._getEasingValue(o,r.tweenEasing))):r.curve&&(o=(n-r.position)/r.duration,o=t.TweenTimelineState._getCurveEasingValue(o,r.curve)),s.copyFrom(r.next.transform),s.minus(r.transform),s.x=r.transform.x+s.x*o,s.y=r.transform.y+s.y*o,s.skewX=r.transform.skewX+s.skewX*o,s.skewY=r.transform.skewY+s.skewY*o,s.scaleX=r.transform.scaleX+s.scaleX*o,s.scaleY=r.transform.scaleY+s.scaleY*o,s.add(i.originTransform)}},n._globalToLocal=function(t){for(var e=t.sortedBones.reverse(),i=0,n=e.length;n>i;++i){var s=e[i];s.parent&&(s.parent.transform.toMatrix(this._helpMatrix),this._helpMatrix.transformPoint(s.transform.x,s.transform.y,s.transform),s.transform.rotation+=s.transform.rotation-s.parent.transform.rotation)}for(var i in t.animations){var a=t.animations[i],r=a.boneTimelines;for(var o in r){var l=r[o];if(l.bone.parent)for(var h=a.getBoneTimeline(l.bone.parent.name),_=0,n=l.frames.length;n>_;++_){var u=l.frames[_];this._getTimelineFrameMatrix(a,h,u.position,this._helpTransform),u.transform.add(l.originTransform),this._helpTransform.toMatrix(this._helpMatrix),this._helpMatrix.transformPoint(u.transform.x,u.transform.y,u.transform),u.transform.rotation+=u.transform.rotation-this._helpTransform.rotation}this._helpTransform.copyFrom(l.originTransform);for(var f=0,n=l.frames.length;n>f;++f){var u=l.frames[f];u.transform.add(this._helpTransform),u.transform.minus(l.bone.transform),0==f?(l.originTransform.copyFrom(u.transform),u.transform.identity()):u.transform.minus(l.originTransform)}}}},e.parseDragonBonesData=function(e){return t.ObjectDataParser.getInstance().parseDragonBonesData(e)},e.parseTextureAtlasData=function(i,n){void 0===n&&(n=1);for(var s={},a=null,r=i[e.SUB_TEXTURE],o=0,l=r.length;l>o;o++){var h=r[o],_=h[e.NAME],u=new t.Rectangle;u.x=h[e.X]/n,u.y=h[e.Y]/n,u.width=h[e.WIDTH]/n,u.height=h[e.HEIGHT]/n,e.FRAME_WIDTH in h?(a=new t.Rectangle,a.x=h[e.FRAME_X]/n,a.y=h[e.FRAME_Y]/n,a.width=h[e.FRAME_WIDTH]/n,a.height=h[e.FRAME_HEIGHT]/n):a=null,s[_]={region:u,frame:a,rotated:!1}}return s},e.DATA_VERSION_2_3="2.3",e.DATA_VERSION_3_0="3.0",e.DATA_VERSION_4_0="4.0",e.DATA_VERSION="4.5",e.TEXTURE_ATLAS="TextureAtlas",e.SUB_TEXTURE="SubTexture",e.FORMAT="format",e.IMAGE_PATH="imagePath",e.WIDTH="width",e.HEIGHT="height",e.ROTATED="rotated",e.FRAME_X="frameX",e.FRAME_Y="frameY",e.FRAME_WIDTH="frameWidth",e.FRAME_HEIGHT="frameHeight",e.DRADON_BONES="dragonBones",e.ARMATURE="armature",e.BONE="bone",e.IK="ik",e.SLOT="slot",e.SKIN="skin",e.DISPLAY="display",e.ANIMATION="animation",e.FFD="ffd",e.FRAME="frame",e.PIVOT="pivot",e.TRANSFORM="transform",e.COLOR="color",e.FILTER="filter",e.VERSION="version",e.IS_GLOBAL="isGlobal",e.FRAME_RATE="frameRate",e.TYPE="type",e.NAME="name",e.PARENT="parent",e.LENGTH="length",e.DATA="data",e.DISPLAY_INDEX="displayIndex",e.Z_ORDER="z",e.BLEND_MODE="blendMode",e.INHERIT_TRANSLATION="inheritTranslation",e.INHERIT_ROTATION="inheritRotation",e.INHERIT_SCALE="inheritScale",e.TARGET="target",e.BEND_POSITIVE="bendPositive",e.CHAIN="chain",e.WEIGHT="weight",e.FADE_IN_TIME="fadeInTime",e.PLAY_TIMES="playTimes",e.SCALE="scale",e.OFFSET="offset",e.POSITION="position",e.DURATION="duration",e.TWEEN_EASING="tweenEasing",e.TWEEN_ROTATE="tweenRotate",e.TWEEN_SCALE="tweenScale",e.CURVE="curve",e.EVENT="event",e.SOUND="sound",e.ACTION="action",e.ACTIONS="actions",e.X="x",e.Y="y",e.SKEW_X="skX",e.SKEW_Y="skY",e.SCALE_X="scX",e.SCALE_Y="scY",e.ALPHA_OFFSET="aO",e.RED_OFFSET="rO",e.GREEN_OFFSET="gO",e.BLUE_OFFSET="bO",e.ALPHA_MULTIPLIER="aM",e.RED_MULTIPLIER="rM",e.GREEN_MULTIPLIER="gM",e.BLUE_MULTIPLIER="bM",e.UVS="uvs",e.VERTICES="vertices",e.TRIANGLES="triangles",e.WEIGHTS="weights",e.SLOT_POSE="slotPose",e.BONE_POSE="bonePose",e.TWEEN="tween",e.KEY="key",e.COLOR_TRANSFORM="colorTransform",e.TIMELINE="timeline",e.PIVOT_X="pX",e.PIVOT_Y="pY",e.LOOP="loop",e.AUTO_TWEEN="autoTween",e.HIDE="hide",e.RECTANGLE="rectangle",e.ELLIPSE="ellipse",e}();t.DataParser=e,egret.registerClass(e,"dragonBones.DataParser")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this)}__extends(i,e);var n=(__define,i),s=n.prototype;return i._getBoolean=function(t,e,i){if(e in t){var n=t[e],s=typeof n;if("boolean"==s)return n;if("string"!=s)return Boolean(n);switch(n){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return i},i._getNumber=function(t,e,i){if(e in t){var n=t[e];return null==n||"NaN"==n?i:Number(n)}return i},i._getString=function(t,e,i){return e in t?String(t[e]):i},i._getParameter=function(t,e,i){return t.length>e?t[e]:i},s._parseArmature=function(e){var n=t.BaseObject.borrowObject(t.ArmatureData);if(n.name=i._getString(e,i.NAME,null),n.frameRate=i._getNumber(e,i.FRAME_RATE,this._data.frameRate),i.TYPE in e&&"string"==typeof e[i.TYPE]?n.type=i._getArmatureType(e[i.TYPE]):n.type=i._getNumber(e,i.TYPE,0),this._armature=n,this._rawBones.length=0,i.BONE in e)for(var s=e[i.BONE],a=0,r=s.length;r>a;++a){var o=s[a],l=this._parseBone(o);n.addBone(l,i._getString(o,i.PARENT,null)),this._rawBones.push(l)}if(i.IK in e)for(var h=e[i.IK],a=0,r=h.length;r>a;++a)this._parseIK(h[a]);if(i.SLOT in e)for(var _=e[i.SLOT],a=0,r=_.length;r>a;++a)n.addSlot(this._parseSlot(_[a]));if(i.SKIN in e)for(var u=e[i.SKIN],a=0,r=u.length;r>a;++a)n.addSkin(this._parseSkin(u[a]));if(i.ANIMATION in e)for(var f=e[i.ANIMATION],a=0,r=f.length;r>a;++a)n.addAnimation(this._parseAnimation(f[a]));return this._armature=null,this._rawBones.length=0,this._isParentCooriinate&&i._getBoolean(e,i.IS_GLOBAL,!0)&&this._globalToLocal(n),n},s._parseBone=function(e){var n=t.BaseObject.borrowObject(t.BoneData);return n.name=i._getString(e,i.NAME,null),n.inheritTranslation=i._getBoolean(e,i.INHERIT_TRANSLATION,!0),n.inheritRotation=i._getBoolean(e,i.INHERIT_ROTATION,!0),n.inheritScale=i._getBoolean(e,i.INHERIT_SCALE,!0),n.length=i._getNumber(e,i.LENGTH,0)*this._armatureScale,i.TRANSFORM in e&&this._parseTransform(e[i.TRANSFORM],n.transform),this._isParentCooriinate&&(n.inheritRotation=!0,n.inheritScale=!1),n},s._parseIK=function(t){var e=this._armature.getBone(i._getString(t,i.BONE in t?i.BONE:i.NAME,null));e&&(e.ik=this._armature.getBone(i._getString(t,i.TARGET,null)),e.bendPositive=i._getBoolean(t,i.BEND_POSITIVE,!0),e.chain=i._getNumber(t,i.CHAIN,0),e.weight=i._getNumber(t,i.WEIGHT,1),e.chain>0&&e.parent&&!e.parent.ik?(e.parent.ik=e.ik,e.parent.chainIndex=0,e.parent.chain=0,e.chainIndex=1):(e.chain=0,e.chainIndex=0))},s._parseSlot=function(e){var n=t.BaseObject.borrowObject(t.SlotData);return n.name=i._getString(e,i.NAME,null),n.parent=this._armature.getBone(i._getString(e,i.PARENT,null)),n.displayIndex=i._getNumber(e,i.DISPLAY_INDEX,0),n.zOrder=i._getNumber(e,i.Z_ORDER,this._armature.sortedSlots.length),i.COLOR in e?(n.color=t.SlotData.generateColor(),this._parseColorTransform(e[i.COLOR],n.color)):n.color=t.SlotData.DEFAULT_COLOR,i.BLEND_MODE in e&&"string"==typeof e[i.BLEND_MODE]?n.blendMode=i._getBlendMode(e[i.BLEND_MODE]):n.blendMode=i._getNumber(e,i.BLEND_MODE,0),this._isParentCooriinate&&(i.COLOR_TRANSFORM in e?(n.color=t.SlotData.generateColor(),this._parseColorTransform(e[i.COLOR_TRANSFORM],n.color)):n.color=t.SlotData.DEFAULT_COLOR),n},s._parseSkin=function(e){var n=t.BaseObject.borrowObject(t.SkinData);if(n.name=i._getString(e,i.NAME,"__default")||"__default",i.SLOT in e){this._skin=n;for(var s=e[i.SLOT],a=0,r=s.length;r>a;++a)this._isParentCooriinate&&this._armature.addSlot(this._parseSlot(s[a])),n.addSlot(this._parseSlotDisplaySet(s[a]));this._skin=null}return n},s._parseSlotDisplaySet=function(e){var n=t.BaseObject.borrowObject(t.SlotDisplayDataSet);if(n.slot=this._armature.getSlot(i._getString(e,i.NAME,null)),i.DISPLAY in e){var s=e[i.DISPLAY],a=n.displays;this._slotDisplayDataSet=n;for(var r=0,o=s.length;o>r;++r)a.push(this._parseDisplay(s[r]));this._slotDisplayDataSet=null}return n},s._parseDisplay=function(e){var n=t.BaseObject.borrowObject(t.DisplayData);if(n.name=i._getString(e,i.NAME,null),i.TYPE in e&&"string"==typeof e[i.TYPE]?n.type=i._getDisplayType(e[i.TYPE]):n.type=i._getNumber(e,i.TYPE,0),n.isRelativePivot=!0,i.PIVOT in e){var s=e[i.PIVOT];n.pivot.x=i._getNumber(s,i.X,0),n.pivot.y=i._getNumber(s,i.Y,0)}else if(this._isParentCooriinate){var a=e[i.TRANSFORM];n.isRelativePivot=!1,n.pivot.x=i._getNumber(a,i.PIVOT_X,0)*this._armatureScale,n.pivot.y=i._getNumber(a,i.PIVOT_Y,0)*this._armatureScale}else n.pivot.x=.5,n.pivot.y=.5;switch(i.TRANSFORM in e&&this._parseTransform(e[i.TRANSFORM],n.transform),n.type){case 0:break;case 1:break;case 2:n.meshData=this._parseMesh(e)}return n},s._parseMesh=function(e){var n=t.BaseObject.borrowObject(t.MeshData),s=e[i.VERTICES],a=e[i.UVS],r=e[i.TRIANGLES],o=Math.floor(s.length/2),l=Math.floor(r.length/3),h=new Array(this._armature.sortedBones.length);if(n.skinned=i.WEIGHTS in e&&e[i.WEIGHTS].length>0,n.uvs.length=2*o,n.vertices.length=2*o,n.vertexIndices.length=3*l,n.skinned){if(n.boneIndices.length=o,n.weights.length=o,n.boneVertices.length=o,i.SLOT_POSE in e){var _=e[i.SLOT_POSE];n.slotPose.a=_[0],n.slotPose.b=_[1],n.slotPose.c=_[2],n.slotPose.d=_[3],n.slotPose.tx=_[4],n.slotPose.ty=_[5]}if(i.BONE_POSE in e)for(var u=e[i.BONE_POSE],f=0,m=u.length;m>f;f+=7){var d=u[f],c=h[d]=new t.Matrix;c.a=u[f+1],c.b=u[f+2],c.c=u[f+3],c.d=u[f+4],c.tx=u[f+5],c.ty=u[f+6],c.invert()}}for(var f=0,g=0,m=s.length;m>f;f+=2){var p=f+1,v=f/2,T=n.vertices[f]=s[f]*this._armatureScale,y=n.vertices[p]=s[p]*this._armatureScale;if(n.uvs[f]=a[f],n.uvs[p]=a[p],n.skinned){var D=e[i.WEIGHTS],b=D[g],E=n.boneIndices[v]=new Array(b),S=n.weights[v]=new Array(b),O=n.boneVertices[v]=new Array(2*b);n.slotPose.transformPoint(T,y,this._helpPoint),T=n.vertices[f]=this._helpPoint.x,y=n.vertices[p]=this._helpPoint.y;for(var B=0;b>B;++B){var A=g+1+2*B,d=D[A],w=this._rawBones[d],M=n.bones.indexOf(w);0>M&&(M=n.bones.length,n.bones[M]=w,n.inverseBindPose[M]=h[d]),n.inverseBindPose[M].transformPoint(T,y,this._helpPoint),E[B]=M,S[B]=D[A+1],O[2*B]=this._helpPoint.x,O[2*B+1]=this._helpPoint.y}g+=2*b+1}}for(var f=0,m=r.length;m>f;++f)n.vertexIndices[f]=r[f];return n},s._parseAnimation=function(e){var n=t.BaseObject.borrowObject(t.AnimationData);n.name=i._getString(e,i.NAME,"__default")||"__default",n.frameCount=Math.max(i._getNumber(e,i.DURATION,1),1),n.position=i._getNumber(e,i.POSITION,0)/this._armature.frameRate,n.duration=n.frameCount/this._armature.frameRate,n.playTimes=i._getNumber(e,i.PLAY_TIMES,1),n.fadeInTime=i._getNumber(e,i.FADE_IN_TIME,0),this._animation=n;var s=i._getString(e,i.ANIMATION,null);if(s)return n.animation=this._armature.getAnimation(s),!n.animation,n;if(this._parseTimeline(e,n,this._parseAnimationFrame),i.BONE in e)for(var a=e[i.BONE],r=0,o=a.length;o>r;++r)n.addBoneTimeline(this._parseBoneTimeline(a[r]));if(i.SLOT in e)for(var l=e[i.SLOT],r=0,o=l.length;o>r;++r)n.addSlotTimeline(this._parseSlotTimeline(l[r]));if(i.FFD in e)for(var h=e[i.FFD],r=0,o=h.length;o>r;++r)n.addFFDTimeline(this._parseFFDTimeline(h[r]));if(this._isParentCooriinate){if(this._isAutoTween=i._getBoolean(e,i.AUTO_TWEEN,!0),this._animationTweenEasing=i._getNumber(e,i.TWEEN_EASING,0)||0,n.playTimes=i._getNumber(e,i.LOOP,1),i.TIMELINE in e){for(var _=e[i.TIMELINE],r=0,o=_.length;o>r;++r)n.addBoneTimeline(this._parseBoneTimeline(_[r]));for(var r=0,o=_.length;o>r;++r)n.addSlotTimeline(this._parseSlotTimeline(_[r]))}}else this._isAutoTween=!1,this._animationTweenEasing=0;for(var r in this._armature.bones){var u=this._armature.bones[r];if(!n.getBoneTimeline(u.name)){var f=t.BaseObject.borrowObject(t.BoneTimelineData),m=t.BaseObject.borrowObject(t.BoneFrameData);f.bone=u,f.frames[0]=m,n.addBoneTimeline(f)}}for(var r in this._armature.slots){var d=this._armature.slots[r];if(!n.getSlotTimeline(d.name)){var c=t.BaseObject.borrowObject(t.SlotTimelineData),g=t.BaseObject.borrowObject(t.SlotFrameData);c.slot=d,g.displayIndex=d.displayIndex,d.color==t.SlotData.DEFAULT_COLOR?g.color=t.SlotFrameData.DEFAULT_COLOR:(g.color=t.SlotFrameData.generateColor(),g.color.copyFrom(d.color)),c.frames[0]=g,n.addSlotTimeline(c),this._isParentCooriinate&&(g.displayIndex=-1)}}return this._animation=null,n},s._parseBoneTimeline=function(e){var n=t.BaseObject.borrowObject(t.BoneTimelineData);n.bone=this._armature.getBone(i._getString(e,i.NAME,null)),this._parseTimeline(e,n,this._parseBoneFrame);for(var s=n.originTransform,a=null,r=0,o=n.frames.length;o>r;++r){var l=n.frames[r];a?a!=l&&l.transform.minus(s):(s.copyFrom(l.transform),l.transform.identity()),a=l}return(1!=n.scale||0!=n.offset)&&(this._animation.hasAsynchronyTimeline=!0),n},s._parseSlotTimeline=function(e){var n=t.BaseObject.borrowObject(t.SlotTimelineData);return n.slot=this._armature.getSlot(i._getString(e,i.NAME,null)),this._parseTimeline(e,n,this._parseSlotFrame),(1!=n.scale||0!=n.offset)&&(this._animation.hasAsynchronyTimeline=!0),n},s._parseFFDTimeline=function(e){var n=t.BaseObject.borrowObject(t.FFDTimelineData);n.skin=this._armature.getSkin(i._getString(e,i.SKIN,null)),n.slot=n.skin.getSlot(i._getString(e,i.SLOT,null));for(var s=i._getString(e,i.NAME,null),a=0,r=n.slot.displays.length;r>a;++a){var o=n.slot.displays[a];if(o.meshData&&o.name==s){n.displayIndex=a,this._mesh=o.meshData;break}}return this._parseTimeline(e,n,this._parseFFDFrame),this._mesh=null,n},s._parseAnimationFrame=function(e,n,s){var a=t.BaseObject.borrowObject(t.AnimationFrameData);return this._parseFrame(e,a,n,s),i.ACTION in e&&this._parseActionData(e,a.actions,null,null),(i.EVENT in e||i.SOUND in e)&&this._parseEventData(e,a.events,null,null),a},s._parseBoneFrame=function(e,n,s){var a=t.BaseObject.borrowObject(t.BoneFrameData);a.parent=this._armature.getBone(i._getString(e,i.PARENT,null)),a.tweenRotate=i._getNumber(e,i.TWEEN_ROTATE,0),a.tweenScale=i._getBoolean(e,i.TWEEN_SCALE,!0),this._parseTweenFrame(e,a,n,s),i.TRANSFORM in e&&this._parseTransform(e[i.TRANSFORM],a.transform);var r=this._timeline.bone;if((i.EVENT in e||i.SOUND in e)&&(this._parseEventData(e,a.events,r,null),this._animation.hasBoneTimelineEvent=!0),i.ACTION in e){var o=this._armature.getSlot(r.name);this._parseActionData(e,a.actions,r,o),this._animation.hasBoneTimelineEvent=!0}return a},s._parseSlotFrame=function(e,n,s){var a=t.BaseObject.borrowObject(t.SlotFrameData);if(a.displayIndex=i._getNumber(e,i.DISPLAY_INDEX,0),this._parseTweenFrame(e,a,n,s),i.COLOR in e||i.COLOR_TRANSFORM in e?(a.color=t.SlotFrameData.generateColor(),this._parseColorTransform(e[i.COLOR]||e[i.COLOR_TRANSFORM],a.color)):a.color=t.SlotFrameData.DEFAULT_COLOR,this._isParentCooriinate)i._getBoolean(e,i.HIDE,!1)&&(a.displayIndex=-1);else if(i.ACTION in e){var r=this._timeline.slot;this._parseActionData(e,a.actions,r.parent,r)}return a},s._parseFFDFrame=function(e,n,s){var a=t.BaseObject.borrowObject(t.ExtensionFrameData);a.type=i._getNumber(e,i.TYPE,0),this._parseTweenFrame(e,a,n,s);for(var r=e[i.VERTICES],o=i._getNumber(e,i.OFFSET,0),l=0,h=0,_=0,u=this._mesh.vertices.length;u>_;_+=2)if(o>_||_-o>=r.length?(l=0,h=0):(l=r[_-o]*this._armatureScale,h=r[_+1-o]*this._armatureScale),this._mesh.skinned){this._mesh.slotPose.transformPoint(l,h,this._helpPoint,!0),l=this._helpPoint.x,h=this._helpPoint.y;for(var f=this._mesh.boneIndices[_/2],m=0,d=f.length;d>m;++m){var c=f[m];this._mesh.inverseBindPose[c].transformPoint(l,h,this._helpPoint,!0),a.tweens.push(this._helpPoint.x,this._helpPoint.y)}}else a.tweens.push(l,h);return a},s._parseTweenFrame=function(e,n,s,a){this._parseFrame(e,n,s,a),i.TWEEN_EASING in e?n.tweenEasing=i._getNumber(e,i.TWEEN_EASING,t.DragonBones.NO_TWEEN):this._isParentCooriinate&&(n.tweenEasing=this._isAutoTween?this._animationTweenEasing:t.DragonBones.NO_TWEEN),i.CURVE in e&&(n.curve=t.TweenFrameData.samplingCurve(e[i.CURVE],a))},s._parseFrame=function(t,e,i,n){e.position=i/this._armature.frameRate,e.duration=n/this._armature.frameRate},s._parseTimeline=function(e,n,s){if(n.scale=i._getNumber(e,i.SCALE,1),n.offset=i._getNumber(e,i.OFFSET,0),this._timeline=n,i.FRAME in e){var a=e[i.FRAME];if(a.length)if(1==a.length)n.frames.length=1,n.frames[0]=s.call(this,a[0],0,i._getNumber(a[0],i.DURATION,1));else{n.frames.length=this._animation.frameCount+1;for(var r=0,o=0,l=null,h=null,_=0,u=0,f=this._animation.frameCount+1;f>_;++_){if(_>=r+o&&u<a.length){var m=a[u++];r=_,o=i._getNumber(m,i.DURATION,1),l=s.call(this,m,r,o),h&&(h.next=l,l.prev=h,this._isParentCooriinate&&h instanceof t.TweenFrameData&&-1==m[i.DISPLAY_INDEX]&&(h.tweenEasing=t.DragonBones.NO_TWEEN)),h=l}n.frames[_]=l}l.duration=this._animation.duration-l.position,l=n.frames[0],h.next=l,l.prev=h,this._isParentCooriinate&&h instanceof t.TweenFrameData&&-1==a[0][i.DISPLAY_INDEX]&&(h.tweenEasing=t.DragonBones.NO_TWEEN)}}this._timeline=null},s._parseActionData=function(e,n,s,a){var r=e[i.ACTION];if("string"==typeof r){var o=t.BaseObject.borrowObject(t.ActionData);o.type=4,o.data=[r,-1,-1],o.bone=s,o.slot=a,n.push(o)}else if(r instanceof Array)for(var l=0,h=r.length;h>l;++l){var _=r[l],o=t.BaseObject.borrowObject(t.ActionData),u=_[0];switch("string"==typeof u?o.type=i._getActionType(u):o.type=i._getParameter(_,0,4),o.type){case 0:o.data=[i._getParameter(_,1,null),i._getParameter(_,2,-1)];break;case 1:o.data=[i._getParameter(_,1,null)];break;case 2:o.data=[i._getParameter(_,1,null),i._getParameter(_,2,0),i._getParameter(_,3,-1)];break;case 3:o.data=[i._getParameter(_,1,null),i._getParameter(_,2,0)];break;case 4:o.data=[i._getParameter(_,1,null),i._getParameter(_,2,-1),i._getParameter(_,3,-1)];break;case 5:o.data=[i._getParameter(_,1,null),i._getParameter(_,2,0)]}o.bone=s,o.slot=a,n.push(o)}},s._parseEventData=function(e,n,s,a){if(i.SOUND in e){var r=t.BaseObject.borrowObject(t.EventData);r.type=1,r.name=e[i.SOUND],r.bone=s,r.slot=a,n.push(r)}if(i.EVENT in e){var o=t.BaseObject.borrowObject(t.EventData);o.type=0,o.name=e[i.EVENT],o.bone=s,o.slot=a,i.DATA in e&&(o.data=e[i.DATA]),n.push(o)}},s._parseTransform=function(e,n){n.x=i._getNumber(e,i.X,0)*this._armatureScale,n.y=i._getNumber(e,i.Y,0)*this._armatureScale,n.skewX=i._getNumber(e,i.SKEW_X,0)*t.DragonBones.ANGLE_TO_RADIAN,n.skewY=i._getNumber(e,i.SKEW_Y,0)*t.DragonBones.ANGLE_TO_RADIAN,n.scaleX=i._getNumber(e,i.SCALE_X,1),n.scaleY=i._getNumber(e,i.SCALE_Y,1)},s._parseColorTransform=function(t,e){e.alphaMultiplier=.01*i._getNumber(t,i.ALPHA_MULTIPLIER,100),e.redMultiplier=.01*i._getNumber(t,i.RED_MULTIPLIER,100),e.greenMultiplier=.01*i._getNumber(t,i.GREEN_MULTIPLIER,100),e.blueMultiplier=.01*i._getNumber(t,i.BLUE_MULTIPLIER,100),e.alphaOffset=i._getNumber(t,i.ALPHA_OFFSET,0),e.redOffset=i._getNumber(t,i.RED_OFFSET,0),e.greenOffset=i._getNumber(t,i.GREEN_OFFSET,0),e.blueOffset=i._getNumber(t,i.BLUE_OFFSET,0)},s.parseDragonBonesData=function(e,n){if(void 0===n&&(n=1),e){var s=i._getString(e,i.VERSION,null);if(this._isParentCooriinate=s==i.DATA_VERSION_2_3||s==i.DATA_VERSION_3_0,this._armatureScale=n,s==i.DATA_VERSION||this._isParentCooriinate){var a=t.BaseObject.borrowObject(t.DragonBonesData);if(a.name=i._getString(e,i.NAME,null),a.frameRate=i._getNumber(e,i.FRAME_RATE,24),i.ARMATURE in e){this._data=a;for(var r=e[i.ARMATURE],o=0,l=r.length;l>o;++o)a.addArmature(this._parseArmature(r[o]));this._data=null}return a}throw new Error("Nonsupport data version.")}throw new Error},s.parseTextureAtlasData=function(e,n,s){if(void 0===s&&(s=0),e){if(n.name=i._getString(e,i.NAME,null),n.imagePath=i._getString(e,i.IMAGE_PATH,null),s>0?n.scale=s:s=n.scale=i._getNumber(e,i.SCALE,n.scale),s=1/s,i.SUB_TEXTURE in e)for(var a=e[i.SUB_TEXTURE],r=0,o=a.length;o>r;++r){var l=a[r],h=n.generateTextureData();h.name=i._getString(l,i.NAME,null),h.rotated=i._getBoolean(l,i.ROTATED,!1),h.region.x=i._getNumber(l,i.X,0)*s,h.region.y=i._getNumber(l,i.Y,0)*s,h.region.width=i._getNumber(l,i.WIDTH,0)*s,h.region.height=i._getNumber(l,i.HEIGHT,0)*s;var _=i._getNumber(l,i.FRAME_WIDTH,-1),u=i._getNumber(l,i.FRAME_HEIGHT,-1);_>0&&u>0&&(h.frame=t.TextureData.generateRectangle(),h.frame.x=i._getNumber(l,i.FRAME_X,0)*s,h.frame.y=i._getNumber(l,i.FRAME_Y,0)*s,h.frame.width=_*s,h.frame.height=u*s),n.addTextureData(h)}return n}throw new Error},i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i._instance=null,i}(t.DataParser);t.ObjectDataParser=e,egret.registerClass(e,"dragonBones.ObjectDataParser")}(dragonBones||(dragonBones={}));